
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº’å‹•å¼ç†è²¡è¦åŠƒä¹‹æ—…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #FDF8F0;
            color: #374151;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .step-card {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
        }
        .nav-link {
            transition: color 0.3s;
        }
        .nav-link:hover, .nav-link.active {
            color: #4A908A;
        }
        .btn-primary {
            background-color: #4A908A;
            color: white;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #3D7A73;
        }
        .btn-secondary {
            background-color: #E5E7EB;
            color: #374151;
            transition: background-color 0.3s;
        }
        .btn-secondary:hover {
            background-color: #D1D5DB;
        }
        .quiz-option.selected {
            background-color: #D1FAE5;
            border-color: #4A908A;
        }
        .badge {
            background-color: #FEF3C7;
            color: #92400E;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        [data-section] {
            scroll-margin-top: 80px;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            border-radius: 1rem;
            padding: 2rem;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(20px);
            opacity: 0;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        .modal-overlay.active .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        .close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6B7280;
        }
        .image-modal-content {
            padding: 0;
            background: none;
            box-shadow: none;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .image-modal-content img {
            max-width: 100%;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 1rem;
            box-shadow: 0 8px 30px rgba(0,0,0,0.5);
        }
        .image-modal-content .close-btn {
            color: white;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
        }
        .gallery-modal-content {
            max-width: 500px;
        }
        .gallery-nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1010;
        }
        .gallery-nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        #gallery-prev-btn {
            left: -50px;
        }
        #gallery-next-btn {
            right: -50px;
        }
        .oracle-card {
            perspective: 1000px;
            cursor: pointer;
        }
        .oracle-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .oracle-card.flipped .oracle-card-inner {
            transform: rotateY(180deg);
        }
        .oracle-card-front, .oracle-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 0.75rem;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        .oracle-card-back {
            background-color: #4A908A;
            color: white;
            font-size: 3rem;
            border: 2px solid #FDF8F0;
        }
        .oracle-card-front {
            background-color: #FEF3C7;
            color: #92400E;
            transform: rotateY(180deg);
        }
        #swipe-card-stack {
            position: relative;
            width: 100%;
            height: 200px;
            margin: 0 auto;
        }
        .swipe-card {
            position: absolute;
            width: 90%;
            height: 180px;
            left: 5%;
            top: 10px;
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            transition: transform 0.3s ease, opacity 0.3s ease;
            cursor: grab;
            user-select: none;
        }
        .swipe-card:active {
             cursor: grabbing;
        }
    </style>
</head>
<body class="antialiased">
    <header id="header" class="bg-white/80 backdrop-blur-md fixed top-0 left-0 right-0 z-50 shadow-sm">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="#" class="flex items-center space-x-2">
                <img src="images/ç¾¤ç›ŠæœŸè²¨logo.png" alt="ç¾¤ç›ŠæœŸè²¨ Logo" class="h-8" onerror="this.onerror=null;this.src='https://placehold.co/200x50/FFFFFF/000000?text=Logo';">
            </a>
            <nav class="hidden md:flex space-x-6 text-gray-600 font-medium">
                <a href="#journey-start" class="nav-link">èµ·é»</a>
                <a href="#step1" class="nav-link">Step 1: é¢¨éšªå±¬æ€§</a>
                <a href="#step2" class="nav-link">Step 2: ç†è²¡ç¿’æ…£</a>
                <a href="#step3" class="nav-link">Step 3: æŠ•è³‡å·¥å…·</a>
                <a href="#step4" class="nav-link">Step 4: å°ˆå±¬è¨ˆç•«</a>
                <a href="#step5" class="nav-link">Step 5: ç«‹å³è¡Œå‹•</a>
            </nav>
            <div class="md:hidden">
                <button id="mobile-menu-btn" class="text-gray-600" aria-label="é–‹å•Ÿé¸å–®">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
                </button>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white/90">
            <a href="#journey-start" class="block py-2 px-4 text-sm text-gray-600 hover:bg-gray-100">èµ·é»</a>
            <a href="#step1" class="block py-2 px-4 text-sm text-gray-600 hover:bg-gray-100">Step 1: é¢¨éšªå±¬æ€§</a>
            <a href="#step2" class="block py-2 px-4 text-sm text-gray-600 hover:bg-gray-100">Step 2: ç†è²¡ç¿’æ…£</a>
            <a href="#step3" class="block py-2 px-4 text-sm text-gray-600 hover:bg-gray-100">Step 3: æŠ•è³‡å·¥å…·</a>
            <a href="#step4" class="block py-2 px-4 text-sm text-gray-600 hover:bg-gray-100">Step 4: å°ˆå±¬è¨ˆç•«</a>
            <a href="#step5" class="block py-2 px-4 text-sm text-gray-600 hover:bg-gray-100">Step 5: ç«‹å³è¡Œå‹•</a>
        </div>
    </header>

    <main class="container mx-auto px-4 pt-24 pb-12">
        <!-- Section: Journey Start -->
        <section id="journey-start" data-section class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">5 åˆ†é˜ï¼Œé è¦‹æ‚¨çš„è²¡å¯Œæœªä¾†</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto mb-8">ç†è²¡ä¸è¤‡é›œã€‚æˆ‘å€‘å°‡è¤‡é›œçš„é‡‘èæ¦‚å¿µï¼Œè½‰åŒ–ç‚ºæœ‰è¶£çš„äº’å‹•æ¨¡æ“¬ï¼Œè®“é›¶ç¶“é©—çš„æ‚¨ï¼Œä¹Ÿèƒ½è¼•é¬†å»ºç«‹è²¡å‹™ä¿¡å¿ƒã€‚</p>
            <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-4">
                <a href="#step1" class="w-full sm:w-auto px-8 py-3 font-semibold rounded-lg btn-primary">å°±æ˜¯ç¾åœ¨ï¼Œé–‹å§‹è¦åŠƒ</a>
                <div id="progress-container" class="w-full sm:w-auto">
                    <span class="font-medium text-gray-700">å­¸ç¿’é€²åº¦ï¼š</span>
                    <div class="w-full sm:w-48 bg-gray-200 rounded-full h-2.5 inline-block align-middle">
                        <div id="progress-bar" class="bg-teal-500 h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                    <span id="progress-percent" class="ml-2 font-semibold">0%</span>
                </div>
            </div>
             <div id="badges-container" class="mt-6 flex justify-center space-x-2"></div>
        </section>

        <!-- Step 1: Risk Assessment -->
        <section id="step1" data-section class="mb-16">
            <div class="step-card">
                <h2 class="text-3xl font-bold text-center mb-2">Step 1: äº†è§£æ‚¨çš„é¢¨éšªå±¬æ€§</h2>
                <p class="text-gray-600 text-center mb-8">æ‚¨æ˜¯ä¸æ˜¯ä¹Ÿè¦ºå¾—ï¼ŒæŠ•è³‡æœ€é›£çš„ä¸æ˜¯é¸æ¨™çš„ï¼Œè€Œæ˜¯ä¸ç¢ºå®šè‡ªå·±èƒ½æ‰¿å—å¤šå°‘è™§æï¼Ÿå®Œæˆé€™å€‹æ¸¬é©—ï¼Œæ‰¾åˆ°æ‚¨ã€Œç¡å¾—è‘—è¦ºã€çš„æŠ•è³‡é¢¨æ ¼ã€‚</p>
                <div id="risk-quiz">
                    <div id="quiz-question-container" class="mb-6"></div>
                    <div id="quiz-navigation" class="flex justify-between items-center">
                        <button id="prev-question" class="px-6 py-2 rounded-lg btn-secondary" disabled>ä¸Šä¸€é¡Œ</button>
                        <span id="question-indicator" class="text-sm text-gray-500"></span>
                        <button id="next-question" class="px-6 py-2 rounded-lg btn-primary" disabled>ä¸‹ä¸€é¡Œ</button>
                    </div>
                </div>
                <div id="risk-result" class="hidden text-center p-6 bg-amber-50 rounded-lg">
                    <h3 class="text-2xl font-bold mb-2">æ¸¬é©—çµæœå‡ºçˆï¼æ‚¨çš„é¢¨éšªå±¬æ€§æ˜¯ï¼š<span id="result-type" class="text-teal-600"></span></h3>
                    <p id="result-desc" class="text-gray-700 mb-4"></p>
                    <p class="font-semibold">æœ€é©åˆæ‚¨çš„æŠ•è³‡å·¥å…·çµ„åˆï¼š<span id="result-tools" class="text-gray-800"></span></p>
                    <div class="mt-4 pt-4 border-t border-amber-200">
                        <p class="font-semibold">å»ºè­°è³‡ç”¢é…ç½®æ¯”ä¾‹ï¼š</p>
                        <p id="result-allocation" class="text-gray-800"></p>
                    </div>
                    <div class="mt-6 pt-4 border-t border-amber-200">
                        <p class="text-gray-700">æƒ³çŸ¥é“å¦‚ä½•ç”¨é€™äº›å·¥å…·ï¼Œæ‰“é€ å°ˆå±¬æ‚¨çš„æŠ•è³‡çµ„åˆå—ï¼Ÿ</p>
                        <a href="https://line.me/R/ti/p/@a6024" target="_blank" class="mt-2 inline-block px-6 py-2 text-sm font-semibold rounded-lg btn-primary">ç«‹å³è«®è©¢ã€ç¾¤ç›Šå°ˆæ¥­é¡§å•ã€‘</a>
                    </div>
                    <button id="retake-quiz" class="mt-4 px-6 py-2 rounded-lg btn-secondary text-sm">é‡æ–°æ¸¬é©—</button>
                </div>
            </div>
        </section>

        <!-- Step 2: Financial Basics (NEW) -->
        <section id="step2" data-section class="mb-16">
             <div class="step-card">
                <h2 class="text-3xl font-bold text-center mb-2">Step 2: æ¢ç´¢æ‚¨çš„ç†è²¡DNA</h2>
                <p class="text-gray-600 text-center mb-8">ç†è²¡ä¸è©²æ˜¯æ¯ç‡¥çš„æ•¸å­—ã€‚æˆ‘å€‘ç”¨å…©å€‹æœ‰è¶£çš„æ¸¬é©—ï¼Œç™¼æ˜æ‚¨çš„ç†è²¡æ½›åŠ›èˆ‡æ¶ˆè²»ç¿’æ…£ï¼</p>
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Oracle Card Game -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-3 text-center">ã€ç¥è«­å åœã€‘æ‚¨çš„ç†è²¡äººæ ¼æ˜¯ï¼Ÿ ğŸ”®</h3>
                        <p id="oracle-instruction" class="text-sm text-gray-600 mb-4 text-center">å¿ƒä¸­é»˜å¿µä»Šå¹´çš„ç†è²¡ç›®æ¨™ï¼Œæ†‘ç›´è¦ºé¸ä¸€å¼µç‰Œ...</p>
                        <div id="oracle-cards-container" class="grid grid-cols-2 gap-4 h-64">
                        </div>
                        <div id="oracle-result-container" class="hidden text-center mt-4">
                            <div class="p-4 bg-amber-100 border border-amber-200 rounded-lg">
                                <div id="oracle-result-emoji" class="text-5xl mb-2"></div>
                                <h4 id="oracle-result-title" class="text-xl font-bold text-amber-800"></h4>
                                <p id="oracle-result-analysis" class="text-sm text-gray-700 mt-2"></p>
                                <p id="oracle-result-guidance" class="text-sm font-semibold text-teal-700 mt-3 p-2 bg-teal-50 rounded-md"></p>
                            </div>
                            <button id="oracle-redraw-btn" class="mt-4 px-6 py-2 rounded-lg btn-secondary text-sm">å†æŠ½ä¸€æ¬¡</button>
                        </div>
                    </div>
                    <!-- Swipe to Save Game -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-3 text-center">ã€æ»‘å‹•æŒ‘æˆ°ã€‘æ‚¨èƒ½çœä¸‹å¤šå°‘éŒ¢ï¼Ÿ â¤ï¸</h3>
                        <p class="text-sm text-gray-600 mb-4 text-center">é¢å°æ¶ˆè²»èª˜æƒ‘ï¼Œæ‚¨æœƒPASSé‚„æ˜¯BUYï¼Ÿå‘å·¦æ»‘PASSï¼Œå‘å³æ»‘BUYï¼</p>
                        <div id="swipe-game-container">
                            <div id="swipe-card-stack">
                            </div>
                            <div id="swipe-actions" class="flex justify-center space-x-8 mt-4">
                                <button id="pass-btn" class="w-16 h-16 rounded-full bg-red-100 text-red-500 text-2xl font-bold flex items-center justify-center shadow-md hover:bg-red-200 transition-colors">âœ•</button>
                                <button id="buy-btn" class="w-16 h-16 rounded-full bg-green-100 text-green-500 text-2xl font-bold flex items-center justify-center shadow-md hover:bg-green-200 transition-colors">â¤ï¸</button>
                            </div>
                        </div>
                        <div id="swipe-result-container" class="hidden text-center mt-4">
                             <div class="p-4 bg-blue-100 border border-blue-200 rounded-lg">
                                <h4 class="text-lg font-bold text-blue-800">çµç®—ï¼</h4>
                                <p class="text-gray-700 mt-2">æ‚¨æˆåŠŸæ‹’çµ•äº† <span id="passed-count" class="font-bold"></span> æ¬¡èª˜æƒ‘ï¼</p>
                                <p class="text-lg mt-1">ç¸½å…±çœä¸‹ï¼š</p>
                                <p class="text-3xl font-bold text-blue-600 my-2">NT$ <span id="saved-amount"></span></p>
                                <p class="text-sm text-gray-600 mt-4">å¦‚æœå°‡é€™ç­†éŒ¢æŠ•è³‡ï¼Œ<br>ä¸€å¹´å¾Œå¯èƒ½æˆé•·ç‚º <span id="invested-saved-amount" class="font-bold text-teal-600"></span>ï¼ (ä»¥7%å¹´åŒ–å ±é…¬ç‡è¨ˆ)</p>
                            </div>
                            <button id="swipe-restart-btn" class="mt-4 px-6 py-2 rounded-lg btn-secondary text-sm">å†ç©ä¸€æ¬¡</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Step 3: Explore Tools -->
        <section id="step3" data-section class class="mb-16">
            <div class="step-card">
                <h2 class="text-3xl font-bold text-center mb-2">Step 3: æ¢ç´¢æ‚¨çš„æŠ•è³‡å·¥å…·ç®±</h2>
                <p class="text-gray-600 text-center mb-8">æ‚¨å·²å…·å‚™åŸºç¤ï¼Œç¾åœ¨ä¾†èªè­˜å„ç¨®æŠ•è³‡å·¥å…·ã€‚æˆ‘å€‘å°‡å¾å…­å¤§å·¥å…·æ¦‚è¦½é–‹å§‹ï¼Œå†æ·±å…¥æ¢è¨æ–°æ‰‹å…¥é–€é¦–é¸çš„ETFã€‚</p>

                <!-- Investment Tools Overview -->
                <div class="mb-12 text-center">
                    <h3 class="text-2xl font-bold mb-2">ã€ä¸€å¼µåœ–çœ‹æ‡‚ã€‘å…­å¤§æŠ•è³‡å·¥å…·</h3>
                    <p class="text-sm text-gray-500 mb-6">é»æ“Šåœ–ç¤ºï¼Œçœ‹æ›´å¤šè©³ç´°è³‡è¨Š</p>
                    <div id="investment-tools-container" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 text-center"></div>
                </div>

                <!-- ETF Deep Dive -->
                <div class="bg-teal-50 p-8 rounded-lg mb-8">
                    <h3 class="text-2xl font-bold text-center mb-2">â­ æ–°æ‰‹å…¥é–€è¶…æ¨çš„ç†ç”±ï¼Œåªæœ‰ä¸€å€‹ï¼šETF</h3>
                    <p class="text-gray-600 text-center max-w-3xl mx-auto mb-8">ETFå°æ–°æ‰‹å‹å–„çš„ç†ç”±å¾ˆå–®ç´”ï¼šã€è‡ªå‹•åˆ†æ•£é¢¨éšªã€‘ã€‚å®ƒåƒä¸€å€‹æ°´æœç¦®ç›’ï¼Œç”¨ä¸€ç­†éŒ¢å°±è²·åˆ°ä¸€ç±ƒå­å…¬å¸çš„è‚¡ç¥¨ã€‚æ­é…ã€Œå®šæœŸå®šé¡ã€ï¼Œæ¯æœˆè‡ªå‹•æŠ•è³‡ï¼Œæ˜¯é¤ŠæˆæŠ•è³‡ç´€å¾‹çš„æœ€ä½³æ–¹æ³•ã€‚</p>
                    
                    <div class="grid md:grid-cols-2 gap-8 items-start">
                        <!-- Popular ETF Comparison -->
                        <div>
                            <h4 class="text-xl font-bold mb-4 text-center">ç†±é–€ETFæ¯”ä¸€æ¯”ï¼š0050 vs. 0056</h4>
                            <p class="text-sm text-gray-600 mb-4 text-center">ä»¥0050(å…ƒå¤§å°ç£50)å’Œ0056(å…ƒå¤§é«˜è‚¡æ¯)ç‚ºä¾‹ï¼Œçœ‹ä¸åŒç­–ç•¥çš„æ­·å²è¡¨ç¾ã€‚</p>
                            <div class="chart-container h-64">
                                <canvas id="etf-comparison-chart"></canvas>
                            </div>
                        </div>
                        <!-- How to pick ETF - Moved here -->
                        <div>
                            <h4 class="text-xl font-semibold mb-3">ã€é¸ETFå¯†æŠ€ã€‘äº”å€‹å¿…çœ‹æŒ‡æ¨™</h4>
                            <ul class="list-disc list-inside text-gray-700 space-y-2">
                                <li><b>çœ‹åç¨±ï¼Œç§’æ‡‚æŠ•è³‡æ¨™çš„</b>ï¼šETFåç¨±æœƒæ­ç¤ºå…¶è¿½è¹¤çš„æŒ‡æ•¸æˆ–è³‡ç”¢é¡åˆ¥ã€‚ <button class="text-blue-600 text-sm ml-2 underline" data-image-modal="name-dividend">å¦‚ä½•çœ‹ï¼Ÿ</button></li>
                                <li><b>ç¸½ç®¡ç†è²»ç”¨ (è¶Šä½è¶Šå¥½)</b>ï¼šæ­¤è²»ç”¨æ¯å¹´å¾æ‚¨çš„æŠ•è³‡ä¸­æ‰£é™¤ï¼Œé•·æœŸä¸‹ä¾†å½±éŸ¿å·¨å¤§ã€‚ <button class="text-blue-600 text-sm ml-2 underline" data-image-modal="expense-ratio">å¦‚ä½•çœ‹ï¼Ÿ</button></li>
                                <li><b>é…æ¯ç‹€æ³ (ç¾é‡‘æµé—œéµ)</b>ï¼šäº†è§£é…æ¯é »ç‡èˆ‡æ­·å²é‡‘é¡ï¼Œå½±éŸ¿æ‚¨çš„ç¾é‡‘æµã€‚ <button class="text-blue-600 text-sm ml-2 underline" data-image-modal="dividend-frequency">å¦‚ä½•çœ‹ï¼Ÿ</button></li>
                                <li><b>æˆåˆ†è‚¡èˆ‡ç”¢æ¥­é…ç½®</b>ï¼šäº†è§£ETFå¯¦éš›æŒæœ‰æ¨™çš„ï¼Œç¢ºä¿ç¬¦åˆæ‚¨çš„æŠ•è³‡ç†å¿µã€‚ <button class="text-blue-600 text-sm ml-2 underline" data-image-modal="composition">å¦‚ä½•çœ‹ï¼Ÿ</button></li>
                                <li><b>æ³¨æ„æŠ˜æº¢åƒ¹ (é¿å…è²·è²´)</b>ï¼šå¸‚åƒ¹èˆ‡æ·¨å€¼(NAV)çš„å·®ç•°ã€‚æº¢åƒ¹æ™‚è²·å…¥å¯èƒ½è²·è²´ã€‚ <button class="text-blue-600 text-sm ml-2 underline" data-image-modal="premium-discount">å¦‚ä½•çœ‹ï¼Ÿ</button></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- New Futures Section - Updated for engagement -->
                <div class="bg-blue-50 p-8 rounded-lg">
                    <h3 class="text-2xl font-bold text-center mb-2">ğŸ’¡ é€²éšå·¥å…·ï¼šæœŸè²¨ï¼Œä¸åªæ˜¯æŠ•æ©Ÿ</h3>
                    <p class="text-gray-600 text-center max-w-3xl mx-auto mb-8">æœŸè²¨ï¼Œè½èµ·ä¾†å¾ˆè¤‡é›œï¼Ÿ<b>ä½†æ˜¯</b>ï¼Œå®ƒæ›´æ˜¯å°ˆæ¥­æŠ•è³‡è€…åœ¨å¸‚å ´é¢¨æš´ä¸­ä¿è­·è³‡ç”¢çš„<b>ã€Œè¶…ç´šç›¾ç‰Œã€ğŸ›¡ï¸</b>ã€‚ä¸€èµ·ä¾†æ­é–‹æœŸè²¨çš„ç¥ç§˜é¢ç´—ï¼</p>
                    
                    <div class="grid md:grid-cols-2 gap-8 items-start">
                        <div>
                            <h4 class="text-xl font-semibold mb-3">ğŸ˜± è‚¡å¸‚å¤§è·Œ2000é»é‚£å¤©ï¼Œæ‚¨é‚„å¥½å—ï¼Ÿ</h4>
                            <p class="text-gray-700 mb-4">
                                é‚„è¨˜å¾—å—ï¼Ÿå°è‚¡æ›¾å› åœ‹éš›æƒ…å‹¢ï¼Œ<b>å–®æ—¥ç‹‚ç€‰è¶…é 2000 é»</b>ï¼Œå‰µä¸‹å²ä¸Šæœ€å¤§è·Œå¹…ï¼è¨±å¤šè‚¡ç¥¨é–‹ç›¤è·Œåœé–æ­»ï¼Œæƒ³è³£éƒ½è³£ä¸æ‰... æ‚¨çš„å¿ƒè‡Ÿé‚„å—å¾—äº†å—ï¼ŸğŸ’”
                            </p>
                            <h4 class="text-xl font-semibold mb-3">ğŸ›¡ï¸ æœŸè²¨ï¼šå¸‚å ´ä¸‹è·Œæ™‚çš„æ•‘å‘½ç¨»è‰</h4>
                            <p class="text-gray-700 mb-4">
                                å¦‚æœç•¶æ™‚æ‚¨æŒæœ‰å¤§é‡è‚¡ç¥¨å»ç„¡æ³•æ­¢æï¼Œè©²æ€éº¼è¾¦ï¼Ÿé€™æ™‚ï¼ŒæœŸè²¨çš„<b>ã€Œæ”¾ç©ºæ©Ÿåˆ¶ã€</b>å°±æ˜¯æ‚¨çš„é¿éšªåˆ©å™¨ï¼
                            </p>
                            <ul class="list-disc list-inside text-gray-700 space-y-1">
                                <li><b>ç©ºå–®ç²åˆ©</b>ï¼šå¸‚å ´è·Œè¶Šå¤šï¼Œæ”¾ç©ºæœŸè²¨è³ºè¶Šå¤šã€‚</li>
                                <li><b>å½Œè£œç¾è²¨æå¤±</b>ï¼šæœŸè²¨ç²åˆ©èƒ½æœ‰æ•ˆæŠµéŠ·è‚¡ç¥¨è·Œåƒ¹ã€‚</li>
                                <li><b>å¤–è³‡éƒ½åœ¨ç”¨</b>ï¼šå°ˆæ¥­å¤–è³‡åœ¨å¸‚å ´å‹•ç›ªæ™‚ï¼Œéƒ½ç”¨æœŸè²¨ç©ºå–®ä¿è­·ç¾è²¨éƒ¨ä½ã€‚</li>
                            </ul>
                            <p class="text-gray-700 mt-2">æœŸè²¨ä¸åªæ˜¯æŠ•æ©Ÿï¼Œæ›´æ˜¯å°ˆæ¥­çš„<b>é¢¨éšªç®¡ç†å·¥å…·</b>ï¼</p>
                        </div>
                        <div>
                            <h4 class="text-xl font-semibold mb-3">ã€è¿·æ€ç ´è§£ã€‘åˆ¥å†èª¤æœƒæœŸè²¨äº†ï¼</h4>
                            <ul class="list-disc list-inside text-gray-700 space-y-3">
                                <li><b>âŒ è¿·æ€ä¸€ï¼šæœŸè²¨æ˜¯è³­åšï¼</b>
                                    <p class="font-normal text-sm mt-1"><b>âœ… çœŸç›¸ï¼š</b> å®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯<b>ã€Œé¿éšªã€</b>ã€‚å°æœ‰ç¾è²¨éƒ¨ä½çš„æŠ•è³‡è€…ï¼Œå®ƒæ˜¯ç®¡ç†é¢¨éšªçš„å·¥å…·ï¼Œå¦‚åŒç‚ºæ‚¨çš„è³‡ç”¢è²·ä¿éšªã€‚</p>
                                </li>
                                <li><b>âŒ è¿·æ€äºŒï¼šæ–°æ‰‹ä¸èƒ½ç¢°ï¼</b>
                                    <p class="font-normal text-sm mt-1"><b>âœ… çœŸç›¸ï¼š</b> ç¾åœ¨æœ‰<b>ã€Œå°å°æŒ‡ã€ã€ã€Œå¾®å°æŒ‡ã€</b>ç­‰å°å‹åˆç´„ï¼Œæ–°æ‰‹å¯åœ¨æ§åˆ¶é¢¨éšªä¸‹é€æ­¥å­¸ç¿’ã€‚å¾æ¨¡æ“¬äº¤æ˜“é–‹å§‹ï¼Œå®‰å…¨å­¸ç¿’ï¼</p>
                                </li>
                                <li><b>âŒ è¿·æ€ä¸‰ï¼šåªèƒ½åšå¤šï¼</b>
                                    <p class="font-normal text-sm mt-1"><b>âœ… çœŸç›¸ï¼š</b> æœŸè²¨å¯ä»¥<b>ã€Œåšå¤šã€ä¹Ÿèƒ½ã€Œåšç©ºã€</b>ï¼ç„¡è«–å¸‚å ´æ¼²è·Œï¼Œéƒ½æœ‰æ½›åœ¨çš„ç²åˆ©èˆ‡é¿éšªæ©Ÿæœƒã€‚ç†Šå¸‚ä¹Ÿèƒ½è³ºéŒ¢ï¼ğŸ˜</p>
                                </li>
                            </ul>
                            <p class="text-gray-700 mt-4">
                                æŒæ¡æœŸè²¨ï¼Œæ‚¨å°±èƒ½åœ¨å¸‚å ´ä¸­æ›´å¾å®¹ï¼
                            </p>
                        </div>
                    </div>

                    <!-- Hedging Simulator -->
                    <div class="mt-8 pt-6 border-t border-blue-200">
                        <h4 class="text-xl font-bold text-center mb-2">ğŸ“‰ ã€é¿éšªæ¨¡æ“¬å™¨ã€‘é«”é©—æœŸè²¨çš„å¨åŠ›</h4>
                        <div class="text-center mb-6">
                            <p class="text-gray-700 max-w-2xl mx-auto mb-4"><b>å¦‚ä½•æ“ä½œé¿éšªï¼Ÿ</b>å¾ˆç°¡å–®ã€‚ç•¶æ‚¨é æœŸå¸‚å ´ä¸‹è·Œæ™‚ï¼Œå»ã€Œæ”¾ç©ºã€(è³£å‡º)èˆ‡æ‚¨è‚¡ç¥¨ç¸½å¸‚å€¼ç­‰å€¼çš„ã€ŒæŒ‡æ•¸æœŸè²¨ã€ã€‚å¦‚æ­¤ä¸€ä¾†ï¼Œè‚¡ç¥¨è™§æå°±èƒ½è¢«æœŸè²¨ç²åˆ©æ‰€æŠµéŠ·ã€‚</p>
                            <p class="text-center text-gray-600 max-w-2xl mx-auto">ç¾åœ¨ï¼Œè¼¸å…¥æ‚¨çš„è³‡ç”¢åƒ¹å€¼å’Œé æœŸè·Œå¹…ï¼Œçœ‹çœ‹æœ‰ç„¡æœŸè²¨é¿éšªçš„é©šäººå·®ç•°ï¼</p>
                        </div>
                        <div class="max-w-xl mx-auto bg-white/50 p-6 rounded-lg shadow-inner">
                            <div class="grid md:grid-cols-2 gap-4 mb-6">
                                <div>
                                    <label for="hedge-stock-value" class="block text-sm font-medium text-gray-700">æ‚¨çš„è‚¡ç¥¨ç¸½å¸‚å€¼ (NT$)</label>
                                    <input type="number" id="hedge-stock-value" value="1000000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="hedge-market-decline" class="block text-sm font-medium text-gray-700">é æœŸå¸‚å ´è·Œå¹… (%)</label>
                                    <input type="number" id="hedge-market-decline" value="10" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-center">
                                <!-- No Hedging -->
                                <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                                    <h5 class="text-lg font-bold text-red-800 mb-2">ğŸ˜± ç„¡é¿éšªæƒ…å¢ƒ</h5>
                                    <div class="text-left space-y-2 text-gray-700">
                                        <p>è‚¡ç¥¨åˆå§‹åƒ¹å€¼: <span class="font-semibold float-right" id="no-hedge-initial">NT$ 1,000,000</span></p>
                                        <p>è‚¡ç¥¨å¸‚å€¼æå¤±: <span class="font-semibold text-red-600 float-right" id="no-hedge-loss">- NT$ 100,000</span></p>
                                        <hr class="border-red-200 my-1">
                                        <p class="text-lg">æœ€çµ‚è³‡ç”¢åƒ¹å€¼: <span class="font-bold text-red-700 float-right" id="no-hedge-final">NT$ 900,000</span></p>
                                    </div>
                                </div>
                                <!-- With Hedging -->
                                <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                                    <h5 class="text-lg font-bold text-green-800 mb-2">ğŸ›¡ï¸ æœ‰æœŸè²¨é¿éšªæƒ…å¢ƒ</h5>
                                    <div class="text-left space-y-2 text-gray-700">
                                        <p>è‚¡ç¥¨åˆå§‹åƒ¹å€¼: <span class="font-semibold float-right" id="hedge-initial">NT$ 1,000,000</span></p>
                                        <p>è‚¡ç¥¨å¸‚å€¼æå¤±: <span class="font-semibold text-red-600 float-right" id="hedge-stock-loss">- NT$ 100,000</span></p>
                                        <p>æœŸè²¨ç©ºå–®ç²åˆ©: <span class="font-semibold text-green-600 float-right" id="hedge-futures-profit">+ NT$ 100,000</span></p>
                                        <hr class="border-green-200 my-1">
                                        <p class="text-lg">æœ€çµ‚è³‡ç”¢åƒ¹å€¼: <span class="font-bold text-green-700 float-right" id="hedge-final">NT$ 1,000,000</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 pt-6 text-center">
                        <h4 class="text-xl font-bold text-gray-800 mb-2">æº–å‚™å¥½ç‚ºæ‚¨çš„è³‡ç”¢ï¼ŒåŠ ä¸Šæœ€å¼·é˜²è­·ç›¾äº†å—ï¼Ÿ</h4>
                        <p class="text-gray-600 mb-4 max-w-2xl mx-auto">å¸‚å ´æ³¢å‹•ç„¡æ³•é æ¸¬ï¼Œä½†æ‚¨çš„é¢¨éšªå¯ä»¥ç®¡ç†ã€‚ç„¡è«–æ˜¯æƒ³ä¿è­·è³‡ç”¢ï¼Œæˆ–åœ¨å¤šé ­å¸‚å ´æ”¾å¤§ç²åˆ©ï¼ŒæœŸè²¨éƒ½æ˜¯æ‚¨ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚</p>
                        <div class="flex flex-col sm:flex-row justify-center items-center space-y-3 sm:space-y-0 sm:space-x-4">
                            <button id="open-tutorial-btn" class="w-full sm:w-auto px-6 py-3 font-semibold rounded-lg btn-primary">çœ‹ã€Œç¾¤ç›Šè¡Œå‹•è´å®¶ã€å¾®å°æŒ‡ä¸‹å–®æ•™å­¸</button>
                            <a href="https://line.me/R/ti/p/@a6024" target="_blank" class="w-full sm:w-auto px-6 py-3 font-semibold rounded-lg btn-secondary">é ˜å–ã€Šæ–°æ‰‹æœŸè²¨æ“ä½œæ‰‹å†Šã€‹</a>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <!-- Step 4: Robo Advisor (UPDATED) -->
        <section id="step4" data-section>
             <div class="step-card">
                <h2 class="text-3xl font-bold text-center mb-2">Step 4: æ‰“é€ æ‚¨çš„å°ˆå±¬ç†è²¡è¨ˆç•«</h2>
                <p class="text-gray-600 text-center mb-8">å°‡ç›®æ¨™åŒ–ç‚ºè¡Œå‹•ã€‚è¨­å®šæ‚¨çš„ç†è²¡ç›®æ¨™èˆ‡æŠ•å…¥è¨ˆç•«ï¼Œæˆ‘å€‘å°‡æ ¹æ“šæ‚¨çš„é¢¨éšªå±¬æ€§ï¼Œæ¨¡æ“¬æœªä¾†çš„å¯èƒ½æ€§ã€‚</p>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Inputs -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <div class="space-y-4">
                            <div>
                                <h3 class="text-xl font-bold mb-3">1. è¨­å®šæ‚¨çš„ç›®æ¨™</h3>
                                <label for="goal-type" class="block text-sm font-medium text-gray-700">æ‚¨çš„ç†è²¡ç›®æ¨™æ˜¯ï¼Ÿ</label>
                                <select id="goal-type" class="robo-input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                                    <option>å¿«é€Ÿå­˜ä¸‹ç¬¬ä¸€æ¡¶é‡‘</option>
                                    <option>ææ—©é€€ä¼‘</option>
                                    <option>è²·æˆ¿åŸºé‡‘</option>
                                    <option>å­å¥³æ•™è‚²åŸºé‡‘</option>
                                    <option>è²¡å¯Œå¢å€¼</option>
                                </select>
                                <label for="goal-amount" class="block text-sm font-medium text-gray-700 mt-4">ç›®æ¨™é‡‘é¡ (NT$)</label>
                                <input type="number" id="goal-amount" value="1000000" step="10000" class="robo-input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                                <label for="goal-years" class="block text-sm font-medium text-gray-700 mt-4">é è¨ˆé”æˆå¹´é™</label>
                                <input type="number" id="goal-years" value="10" class="robo-input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div class="pt-4 border-t">
                                <h3 class="text-xl font-bold mb-3">2. è¦åŠƒæ‚¨çš„æŠ•å…¥</h3>
                                <label for="lump-sum" class="block text-sm font-medium text-gray-700">å–®ç­†æŠ•å…¥é‡‘é¡ (NT$)</label>
                                <input type="number" id="lump-sum" value="50000" step="1000" class="robo-input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                                <label for="monthly-investment" class="block text-sm font-medium text-gray-700 mt-4">æ¯æœˆå®šæœŸå®šé¡ (NT$)</label>
                                <input type="number" id="monthly-investment" value="5000" step="500" class="robo-input mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                        </div>
                    </div>

                    <!-- Results & Customization -->
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-xl font-bold mb-3 text-center">3. æ‚¨çš„æŠ•è³‡çµ„åˆé…ç½®</h3>
                        <div id="robo-results-container">
                            <div class="text-center p-4 bg-white rounded-lg shadow-inner">
                                <p class="text-gray-600">è¨ˆç•«æˆåŠŸæ©Ÿç‡</p>
                                <p id="success-probability" class="text-5xl font-bold text-teal-600 my-2">--%</p>
                            </div>
                            <div id="portfolio-customization" class="mt-4 space-y-3">
                                <div class="text-center mb-4">
                                    <p class="font-semibold text-lg">å‰©é¤˜å¯åˆ†é…æ¯”ä¾‹: <span id="remaining-alloc-pct" class="text-teal-600">0%</span></p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium">ä¿å®ˆå‹è³‡ç”¢ (å¦‚å‚µåˆ¸)</label>
                                    <div class="flex items-center">
                                        <input type="number" id="conservative-alloc-input" class="w-full portfolio-alloc-input mt-1 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" min="0" max="100" step="1">
                                        <span class="ml-2 font-semibold">%</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium">ç©©å¥å‹è³‡ç”¢ (å¦‚è‚¡å‚µå¹³è¡¡ETF)</label>
                                     <div class="flex items-center">
                                        <input type="number" id="moderate-alloc-input" class="w-full portfolio-alloc-input mt-1 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" min="0" max="100" step="1">
                                        <span class="ml-2 font-semibold">%</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium">ç©æ¥µå‹è³‡ç”¢ (å¦‚è‚¡ç¥¨)</label>
                                     <div class="flex items-center">
                                        <input type="number" id="aggressive-alloc-input" class="w-full portfolio-alloc-input mt-1 px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm" min="0" max="100" step="1">
                                        <span class="ml-2 font-semibold">%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 text-center p-3 bg-white rounded-lg shadow-inner">
                                <p class="text-gray-600 flex items-center justify-center">
                                    ç¶œåˆé æœŸå¹´åŒ–å ±é…¬ç‡
                                    <button id="rate-info-btn" class="ml-2 w-5 h-5 bg-gray-200 text-gray-600 rounded-full text-sm font-bold flex items-center justify-center hover:bg-gray-300 transition-colors">?</button>
                                </p>
                                <p id="combined-return-rate" class="text-2xl font-bold text-teal-600 my-1">--%</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chart -->
                <div class="mt-8">
                    <h3 class="text-2xl font-bold text-center mb-4">æ‚¨çš„è³‡ç”¢æˆé•·é æ¸¬</h3>
                    <div class="chart-container">
                        <canvas id="asset-growth-chart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEW: Step 5 -->
        <section id="step5" data-section>
            <div class="step-card text-center">
                <h2 class="text-3xl font-bold text-center mb-4">Step 5: è¸å‡ºçœŸå¯¦çš„ç¬¬ä¸€æ­¥</h2>
                <p class="text-lg text-gray-600 max-w-2xl mx-auto mb-8">æ­å–œæ‚¨å®Œæˆæ‰€æœ‰å­¸ç¿’ï¼æ‚¨å°ç†è²¡å·²æœ‰å…¨é¢äº†è§£ï¼Œæ˜¯æ™‚å€™å°‡çŸ¥è­˜è½‰åŒ–ç‚ºè¡Œå‹•äº†ã€‚</p>
                <div class="flex flex-col md:flex-row justify-center items-center gap-6">
                    <!-- Option A -->
                    <div class="w-full md:w-1/2 bg-teal-50 p-6 rounded-lg border border-teal-200">
                        <h3 class="text-xl font-bold text-teal-800 mb-3">æˆ‘æº–å‚™å¥½äº†ï¼Œæƒ³é–‹å§‹çœŸå¯¦äº¤æ˜“ï¼</h3>
                        <p class="text-gray-600 mb-4">ç«‹å³é–‹ç«‹æœŸè²¨å¸³æˆ¶ï¼Œå°‡æ‰€å­¸çš„é¿éšªèˆ‡æŠ•è³‡ç­–ç•¥æ‡‰ç”¨æ–¼çœŸå¯¦å¸‚å ´ã€‚</p>
                        <a href="https://goplus.capital.com.tw?Market=F&IBNO=2B50F0CB7BD457AC&EmpNo=FF76AA569B7CA1B4#Futures" target="_blank" class="inline-block px-8 py-3 font-semibold rounded-lg btn-primary">å°±æ˜¯ç¾åœ¨ï¼Œç«‹å³ç·šä¸Šé–‹æˆ¶</a>
                    </div>
                    <!-- Option B -->
                    <div class="w-full md:w-1/2 bg-blue-50 p-6 rounded-lg border border-blue-200">
                        <h3 class="text-xl font-bold text-blue-800 mb-3">æˆ‘æƒ³å…ˆäº†è§£æ›´å¤šå¸‚å ´è³‡è¨Šã€‚</h3>
                        <p class="text-gray-600 mb-4">åŠ å…¥æˆ‘å€‘çš„å®˜æ–¹LINEï¼Œæ¯æ—¥ç²å–å°ˆæ¥­çš„ç›¤å‹¢åˆ†æèˆ‡äº¤æ˜“ç­–ç•¥ã€‚</p>
                        <a href="https://line.me/R/ti/p/@a6024" target="_blank" class="inline-block px-8 py-3 font-semibold rounded-lg btn-secondary">åŠ å…¥LINEå¥½å‹</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- UPDATED: LINE Integration Section -->
        <section id="line-integration" class="text-center my-16 p-8 bg-green-100 rounded-lg shadow-lg">
            <h2 class="text-3xl font-bold text-green-800 mb-4">åŠ å…¥æˆ‘å€‘çš„LINEï¼ŒæŒæ¡æœŸè²¨è‡´å‹å…ˆæ©Ÿï¼</h2>
            <p class="text-lg text-green-700 max-w-3xl mx-auto mb-6">
                æƒ³ç²å¾—å³æ™‚çš„å°æŒ‡æœŸç›¤å‹¢åˆ†æï¼Œæˆ–æœ‰ä»»ä½•æœŸè²¨ç–‘å•å—ï¼Ÿç«‹å³åŠ å…¥æˆ‘å€‘çš„LINEå®˜æ–¹å¸³è™Ÿï¼Œè®“å°ˆæ¥­åœ˜éšŠæˆç‚ºæ‚¨ç†è²¡è·¯ä¸Šçš„ç¥éšŠå‹ï¼
            </p>
            <a href="https://line.me/R/ti/p/@a6024" target="_blank" class="inline-block px-8 py-3 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-600 transition-colors duration-300">
                åŠ å…¥LINEå¥½å‹ï¼Œç«‹å³è«®è©¢
            </a>
            <p class="text-sm text-green-600 mt-4">æˆ–æœå°‹ LINE ID: @a6024</p>
        </section>
        
        <!-- Why Us Section -->
        <section id="why-us" class="my-16">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">ç‚ºä½•é¸æ“‡ç¾¤ç›ŠæœŸè²¨ï¼Ÿ</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-12">é¸æ“‡ç¾¤ç›Šï¼Œç†ç”±åªæœ‰ä¸‰å€‹ï¼šã€é ‚å°–å·¥å…·ã€‘ã€ã€ç¨å®¶å ±å‘Šã€‘ã€ã€å°ˆæ¥­æœå‹™ã€‘ï¼Œæˆç‚ºæ‚¨æœ€å …å¯¦çš„å¾Œç›¾ã€‚</p>
                <div class="grid md:grid-cols-3 gap-8 text-left">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-teal-700 mb-3">1. é ‚å°–äº¤æ˜“å·¥å…·</h3>
                        <p class="text-gray-600">æœ€æ–°ç¾¤ç›Šè´å®¶PROã€è¡Œå‹•è´å®¶ç­‰å¤šæ¬¾APPä»»æ‚¨æŒ‘é¸ï¼Œæ›´æœ‰24å°æ™‚äº¤æ˜“å®¤éš¨æ™‚å¾…å‘½ï¼Œä¸æ€•æ–·ç·šå•é¡Œã€‚</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-teal-700 mb-3">2. ç¨å®¶æŠ•é¡§å ±å‘Š</h3>
                        <p class="text-gray-600">åƒ…éœ€ç™¾å…ƒè²»ç”¨ï¼Œå³äº«å°ˆæ¥­ç ”ç©¶åœ˜éšŠçš„ç¨å®¶å ±å‘Šï¼Œè®“æ‚¨çš„äº¤æ˜“æ±ºç­–æœ‰æ›´å¼·æ•¸æ“šå¾Œç›¾ã€‚</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold text-teal-700 mb-3">3. æ‚¨çš„å°ˆå±¬æœå‹™å“¡</h3>
                        <p class="text-gray-600">é–‹æˆ¶å¾Œï¼Œæ‚¨å°‡æœ‰å°ˆå±¬æœå‹™å“¡ï¼Œè¦ªè‡ªæ•™æ‚¨æ“ä½œç³»çµ±ï¼Œä¸¦è¿…é€Ÿå›ç­”æ‰€æœ‰å•é¡Œã€‚</p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-white pt-10 pb-6">
        <div class="container mx-auto px-4 text-center">
            <img src="images/ç¾¤ç›ŠæœŸè²¨logo.png" alt="ç¾¤ç›ŠæœŸè²¨ Logo" class="h-10 mx-auto mb-6" onerror="this.onerror=null;this.src='https://placehold.co/200x50/1F2937/FFFFFF?text=Logo';">
            <div class="text-xs text-gray-400 max-w-3xl mx-auto space-y-2">
                <p>
                    <span class="font-bold text-gray-300">ã€è­¦èªã€‘</span>
                    æœŸè²¨äº¤æ˜“å…·é«˜é¢¨éšªï¼Œäº¤æ˜“äººæ‡‰è©•ä¼°è‡ªèº«è³‡é‡‘åŠé¢¨éšªæ‰¿å—èƒ½åŠ›ï¼Œéå»ç¸¾æ•ˆä¸ä¿è­‰æœªä¾†ç²åˆ©ã€‚
                </p>
                <p>
                    å…¬å¸åç¨±:ç¾¤ç›ŠæœŸè²¨è‚¡ä»½æœ‰é™å…¬å¸ | å…¬å¸åœ°å€: å°åŒ—å¸‚å¤§å®‰å€æ•¦åŒ–å—è·¯äºŒæ®µ97è™ŸB1 | å…¬å¸é›»è©±: (02)2700-2888 | 114å¹´é‡‘ç®¡æœŸç¸½å­—ç¬¬006è™Ÿ
                </p>
            </div>
        </div>
    </footer>

    <!-- Tool Detail Modal -->
    <div id="tool-detail-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <button class="close-btn" id="close-tool-detail-modal" aria-label="é—œé–‰å·¥å…·è©³ç´°è³‡è¨Š">&times;</button>
            <div class="text-center mb-6">
                <div id="tool-detail-icon" class="text-5xl mb-2"></div>
                <h3 id="tool-detail-name" class="text-3xl font-bold text-gray-800"></h3>
                <span id="tool-detail-risk" class="text-sm px-3 py-1 rounded-full font-medium mt-2 inline-block"></span>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <div>
                    <h4 class="text-xl font-semibold mb-2">å„ªé»</h4>
                    <ul id="tool-detail-advantages" class="list-disc list-inside text-gray-700 space-y-1"></ul>
                </div>
                <div>
                    <h4 class="text-xl font-semibold mb-2">ç¼ºé»</h4>
                    <ul id="tool-detail-disadvantages" class="list-disc list-inside text-gray-700 space-y-1"></ul>
                </div>
            </div>
            
            <div class="mb-6">
                <h4 class="text-xl font-semibold mb-2">é©åˆå°è±¡</h4>
                <p id="tool-detail-suitable" class="text-gray-700"></p>
            </div>

            <div id="tool-detail-interactive-section" class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                <h4 id="interactive-section-title" class="text-xl font-semibold mb-3"></h4>
                <div id="interactive-content"></div>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="image-modal-overlay" class="modal-overlay">
        <div class="modal-content image-modal-content">
            <button class="close-btn" id="close-image-modal" aria-label="é—œé–‰åœ–ç‰‡">&times;</button>
            <img id="image-modal-img" src="" alt="ETF Information">
        </div>
    </div>
    
    <!-- Tutorial Gallery Modal -->
    <div id="gallery-modal-overlay" class="modal-overlay">
        <div class="modal-content gallery-modal-content relative">
            <button class="close-btn" id="close-gallery-modal" aria-label="é—œé–‰æ•™å­¸">&times;</button>
            <div class="w-full">
                <h3 id="gallery-modal-title" class="text-xl font-bold text-center mb-4"></h3>
                <div class="relative">
                    <img id="gallery-modal-img" src="" alt="æ•™å­¸æ­¥é©Ÿ" class="w-full rounded-lg shadow-lg">
                    <button id="gallery-prev-btn" class="gallery-nav-btn">&lt;</button>
                    <button id="gallery-next-btn" class="gallery-nav-btn">&gt;</button>
                </div>
                <p id="gallery-step-indicator" class="text-center mt-4 text-gray-600 font-semibold"></p>
            </div>
        </div>
    </div>

    <!-- Rate Info Modal -->
    <div id="rate-info-modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <button class="close-btn" id="close-rate-info-modal" aria-label="é—œé–‰èªªæ˜">&times;</button>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">é æœŸå ±é…¬ç‡èªªæ˜</h3>
            <div class="text-gray-700 space-y-4">
                <p>ç‚ºäº†æä¾›æ‚¨ä¸€å€‹åˆç†çš„è³‡ç”¢æˆé•·æ¨¡æ“¬ï¼Œæˆ‘å€‘åƒè€ƒäº†é•·æœŸçš„å¸‚å ´æ•¸æ“šèˆ‡å°ˆæ¥­æ©Ÿæ§‹çš„ç ”ç©¶ï¼Œç‚ºä¸åŒé¢¨éšªç­‰ç´šçš„è³‡ç”¢è¨­å®šäº†ä»¥ä¸‹çš„é æœŸå¹´åŒ–å ±é…¬ç‡ï¼š</p>
                <div class="p-4 bg-gray-50 rounded-lg">
                    <p><b>â€¢ ç©æ¥µå‹è³‡ç”¢ (10%)ï¼š</b>ä¸»è¦åƒè€ƒå…¨çƒè‚¡ç¥¨å¸‚å ´çš„é•·æœŸè¡¨ç¾ï¼Œä¾‹å¦‚ MSCI ä¸–ç•ŒæŒ‡æ•¸éå»æ•¸åå¹´çš„å¹³å‡å¹´åŒ–å ±é…¬ç‡ç´„åœ¨ 10% å·¦å³ã€‚</p>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg">
                    <p><b>â€¢ ç©©å¥å‹è³‡ç”¢ (7%)ï¼š</b>æ­¤ç‚ºå…¸å‹çš„ã€Œè‚¡å‚µå¹³è¡¡ã€æŠ•è³‡çµ„åˆï¼ˆå¦‚ 60% è‚¡ç¥¨ã€40% å‚µåˆ¸ï¼‰çš„é•·æœŸé æœŸå›å ±ã€‚è‚¡ç¥¨éƒ¨åˆ†æä¾›æˆé•·æ½›åŠ›ï¼Œå‚µåˆ¸éƒ¨åˆ†å‰‡æä¾›ç©©å®šæ€§ã€‚</p>
                </div>
                <div class="p-4 bg-gray-50 rounded-lg">
                    <p><b>â€¢ ä¿å®ˆå‹è³‡ç”¢ (3.5%)ï¼š</b>ä¸»è¦åƒè€ƒé«˜å“è³ªçš„æŠ•è³‡ç­‰ç´šå‚µåˆ¸çš„é•·æœŸå¹³å‡æ®–åˆ©ç‡ï¼Œä¾‹å¦‚å½­åšå…¨çƒç¶œåˆå‚µåˆ¸æŒ‡æ•¸ (Bloomberg Global Aggregate Bond Index)ã€‚</p>
                </div>
                <div class="mt-4 p-4 bg-amber-50 border-l-4 border-amber-400 text-amber-800">
                    <p><b>ã€é‡è¦æé†’ã€‘</b></p>
                    <p class="mt-2 text-sm">é€™äº›æ•¸å­—æ˜¯åŸºæ–¼æ­·å²æ•¸æ“šçš„é•·æœŸå¹³å‡å€¼ï¼Œåƒ…ä½œç‚ºæ¨¡æ“¬èˆ‡æ•™è‚²ç”¨é€”ï¼Œ**çµ•ä¸ä»£è¡¨æœªä¾†çš„å¯¦éš›å ±é…¬**ã€‚çœŸå¯¦çš„æŠ•è³‡å ±é…¬æœƒå› å¸‚å ´ç‹€æ³ã€ç¶“æ¿Ÿç’°å¢ƒåŠæ‰€é¸æ¨™çš„è€Œæœ‰æ¥µå¤§å·®ç•°ã€‚éå»çš„ç¸¾æ•ˆç„¡æ³•ä¿è­‰æœªä¾†çš„ç²åˆ©ã€‚</p>
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const appState = {
        riskProfile: null, // 'conservative', 'moderate', 'aggressive'
        progress: 0,
        completedSections: new Set(),
        portfolioAllocation: {
            conservative: 34,
            moderate: 33,
            aggressive: 33,
        }
    };

    const sections = document.querySelectorAll('[data-section]');
    const navLinks = document.querySelectorAll('.nav-link');
    const progressBar = document.getElementById('progress-bar');
    const progressPercent = document.getElementById('progress-percent');
    const badgesContainer = document.getElementById('badges-container');
    
    function updateProgress(sectionId) {
        if (!appState.completedSections.has(sectionId)) {
            appState.completedSections.add(sectionId);
            const totalSections = sections.length;
            appState.progress = Math.round((appState.completedSections.size / totalSections) * 100);
            progressBar.style.width = `${appState.progress}%`;
            progressPercent.textContent = `${appState.progress}%`;
            updateBadges();
        }
    }

    function updateBadges() {
        let badgesHTML = '';
        if (appState.completedSections.has('step1')) {
            badgesHTML += '<span class="badge">ğŸ’¡ é¢¨éšªè©•ä¼°è€…</span>';
        }
        if (appState.completedSections.has('step2')) {
            badgesHTML += '<span class="badge">ğŸ’° ç†è²¡æ¢éšªå®¶</span>';
        }
        if (appState.completedSections.has('step3')) {
            badgesHTML += '<span class="badge">ğŸ” å·¥å…·æ¢ç´¢å®¶</span>';
        }
        if (appState.completedSections.has('step4')) {
            badgesHTML += '<span class="badge">ğŸš€ ç†è²¡è¦åŠƒå¸«</span>';
        }
        if (appState.completedSections.has('step5')) {
            badgesHTML += '<span class="badge">ğŸ† ç†è²¡ç•¢æ¥­ç”Ÿ</span>';
        }
        badgesContainer.innerHTML = badgesHTML;
    }

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute('id');
                updateProgress(id);
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href').substring(1) === id);
                });
            }
        });
    }, { threshold: 0.3 });

    sections.forEach(section => observer.observe(section));

    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
    });

    document.querySelectorAll('#mobile-menu a, .nav-link').forEach(link => {
        link.addEventListener('click', () => {
             if (!mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
            }
        });
    });

    // --- é¢¨éšªæ¸¬é©—é–‹å§‹ ---

    const quizData = [
        {
            question: "å‡è¨­æ‚¨çªç„¶å¤±å»æ‰€æœ‰æ”¶å…¥ï¼Œç›®å‰çš„å„²è“„å¤§ç´„å¯ä»¥æ”¯æ’æ‚¨å¤šä¹…çš„åŸºæœ¬ç”Ÿæ´»é–‹éŠ·ï¼Ÿ",
            options: [
                { text: "ğŸ˜° å°‘æ–¼ 1 å€‹æœˆ", score: 1 },
                { text: "ğŸ¤” 1 ~ 3 å€‹æœˆ", score: 2 },
                { text: "ğŸ˜Š 3 ~ 6 å€‹æœˆ", score: 3 },
                { text: "ğŸ˜ 6 å€‹æœˆ ~ 1 å¹´", score: 4 },
                { text: "ğŸ‘‘ 1 å¹´ä»¥ä¸Š", score: 5 },
            ],
        },
        {
            question: "æ‚¨å¹³å¸¸çš„éŒ¢ä¸»è¦ä¾†è‡ªå“ªè£¡ï¼Ÿ",
            options: [
                { text: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶äººçµ¦çš„é›¶ç”¨éŒ¢ï¼ç”Ÿæ´»è²»", score: 1 },
                { text: "ğŸ’¼ æ‰“å·¥æ”¶å…¥ï¼ˆå¦‚é¤å»³ã€å®¶æ•™ç­‰ï¼‰", score: 2 },
                { text: "ğŸ‘” æ­£è·è–ªæ°´ï¼ˆæœä¹æ™šäº” or æ’ç­ç©©å®šï¼‰", score: 3 },
                { text: "ğŸ“ çå­¸é‡‘ï¼æ”¿åºœè£œåŠ©", score: 4 },
                { text: "ğŸš€ è‡ªå·±æ¥æ¡ˆæˆ–å‰µæ¥­æ”¶å…¥ï¼ˆè‡ªç”±æ¥æ¡ˆã€ç¶“ç‡Ÿå‰¯æ¥­ï¼‰", score: 5 },
            ],
        },
        {
            question: "è«‹å•æ‚¨æŠ•è³‡ç†è²¡ï¼Œæœ€ä¸»è¦æƒ³é”æˆçš„è²¡å‹™ç›®æ¨™æ˜¯ä»€éº¼ï¼Ÿ",
            options: [
                { text: "ğŸ¦ å°æŠ—é€šè²¨è†¨è„¹ï¼Œå¸Œæœ›è³‡ç”¢ä¸è¦ç¸®æ°´", score: 1 },
                { text: "ğŸ’¸ è³ºå–é¡å¤–æ”¶å…¥ï¼Œå¢åŠ æ¯æœˆçš„å¯ç”¨ç¾é‡‘æµ", score: 2 },
                { text: "ğŸ§º æº–å‚™ä¸­æœŸç›®æ¨™ï¼Œä¾‹å¦‚è²·æˆ¿é ­æœŸæ¬¾ã€å‰µæ¥­åŸºé‡‘ (3-10å¹´)", score: 3 },
                { text: "ğŸ“ˆ è¦åŠƒé•·æœŸç›®æ¨™ï¼Œä¾‹å¦‚é€€ä¼‘é‡‘ã€å­å¥³æ•™è‚²åŸºé‡‘ (10å¹´ä»¥ä¸Š)", score: 4 },
                { text: "ğŸš€ è¿½æ±‚è²¡å¯Œè‡ªç”±ï¼Œå¸Œæœ›èƒ½ç›¡æ—©é”æˆï¼Œä¸å†ç‚ºéŒ¢å·¥ä½œ", score: 5 },
            ],
        },
        {
            question: "è«‹å•æ‚¨å°é€™ç­†è³‡é‡‘çš„æŠ•è³‡ï¼Œé è¨ˆçš„æŒæœ‰æ™‚é–“æ˜¯å¤šä¹…ï¼Ÿ",
            options: [
                { text: "ğŸ§ª å°‘æ–¼ 1 å¹´ (å°æ‡‰çŸ­æœŸäº¤æ˜“ã€è³‡é‡‘é€±è½‰)", score: 1 },
                { text: "â³ 1 ~ 3 å¹´ (å°æ‡‰çŸ­æœŸå„²è“„ã€ç›®æ¨™)", score: 2 },
                { text: "ğŸ§­ 3 ~ 5 å¹´ (å°æ‡‰ä¸­æœŸè¦åŠƒï¼Œå¦‚é€²ä¿®ã€æ›è»Š)", score: 3 },
                { text: "ğŸŒ³ 5 ~ 10 å¹´ (å°æ‡‰ä¸­é•·æœŸè¦åŠƒï¼Œå¦‚é ­æœŸæ¬¾)", score: 4 },
                { text: "ğŸš€ 10 å¹´ä»¥ä¸Š (å°æ‡‰é•·æœŸè¦åŠƒï¼Œå¦‚é€€ä¼‘ã€å­å¥³æ•™è‚²)", score: 5 },
            ],
        },
        {
            question: "å¦‚æœæ‚¨æŠ•è³‡ 1 è¬å…ƒï¼ŒçŸ­æœŸå…§è™§æå¤šå°‘æ‚¨é‚„èƒ½æ¥å—ï¼Ÿ",
            options: [
                { text: "ğŸ˜° è™§æè¶…é 1,000 å…ƒæˆ‘å°±æœƒæƒ³å‡ºå ´ï¼ˆ-10%ï¼‰", score: 1 },
                { text: "ğŸ˜Ÿ è™§æ 1,500 å…ƒä»¥å…§é‚„å¯ä»¥æ¥å—ï¼ˆ-15%ï¼‰", score: 2 },
                { text: "ğŸ˜ è™§åˆ° 2,000 å…ƒæˆ‘æœƒè§€å¯Ÿä¸€ä¸‹ï¼ˆ-20%ï¼‰", score: 3 },
                { text: "ğŸ™‚ è™§ 2,500 å…ƒæˆ‘ä¹Ÿä¸æœƒå¤ªç·Šå¼µï¼ˆ-25%ï¼‰", score: 4 },
                { text: "ğŸ˜ è™§æè¶…é 2,500 å…ƒæˆ‘éƒ½èƒ½æ·¡å®šé¢å°ï¼ˆè¶…é -25%ï¼‰", score: 5 },
            ],
        },
        {
            question: "å¦‚æœæ‚¨ç™¼ç¾æŠ•è³‡å¸³æˆ¶å‡ºç¾è™§æï¼Œæ‚¨çš„ç¬¬ä¸€åæ‡‰æœƒæ˜¯ï¼Ÿ",
            options: [
                { text: "ğŸ˜¨ ã€Œæ…˜äº†æˆ‘è¦è³£æ‰ï¼ã€ ä¸€çœ‹åˆ°è™§æå°±æƒ³ç«‹åˆ»è³£å‡º", score: 1 },
                { text: "ğŸ˜Ÿ ã€Œå¿ƒå¥½æ…Œ...ã€ æœƒç„¦æ…®ã€æœƒä¸€ç›´ç›¯ç›¤ï¼Œä½†é‚„æ˜¯å…ˆæ”¾è‘—", score: 2 },
                { text: "ğŸ˜ ã€Œå…ˆè§€å¯Ÿä¸€ä¸‹å§ã€ è¦ºå¾—å¸‚å ´æœ‰èµ·æœ‰è½ï¼Œå…ˆä¸æ€¥è‘—è³£", score: 3 },
                { text: "ğŸ™‚ ã€Œé€™åªæ˜¯çŸ­æœŸæ³¢å‹•ã€ å·²ç¶“é æœŸæœƒæ¼²æ¼²è·Œè·Œï¼Œä¸å¤ªåœ¨æ„", score: 4 },
                { text: "ğŸ˜ ã€Œä¾¿å®œè€¶ï¼åŠ ç¢¼ï¼ã€ å¸‚å ´è·Œåè€Œæƒ³åŠ ç¢¼ã€è¦ºå¾—æ˜¯æ©Ÿæœƒ", score: 5 },
            ],
        },
        {
            question: "æ‚¨è¦ºå¾—è‡ªå·±æœ‰å¤šæ‡‚ç†è²¡ï¼Ÿ",
            options: [
                { text: "ğŸ˜µ å®Œå…¨ä¸æ‡‚ï¼Œç†è²¡é›¢æˆ‘å¥½é ...", score: 1 },
                { text: "ğŸ¤” è½éä¸€äº›ï¼Œä½†é‚„æ²’é–‹å§‹åš", score: 2 },
                { text: "ğŸ“ æœ‰è©¦è‘—è¨˜å¸³ï¼å­˜éŒ¢ï¼Œä½†æ²’è¦åŠƒæ–¹å‘", score: 3 },
                { text: "ğŸ“Š æœƒåˆ†é…æ”¶å…¥ï¼Œå¶çˆ¾çœ‹çœ‹ ETF æˆ–åŸºé‡‘", score: 4 },
                { text: "ğŸ§© æˆ‘æœ‰è‡ªå·±çš„ç†è²¡ç­–ç•¥ï¼Œä¹Ÿé–‹å§‹é…ç½®è³‡ç”¢äº†", score: 5 },
            ],
        },
        {
            question: "æ‚¨ç›®å‰æœ€å¤šéŒ¢æ˜¯æŠ•åœ¨å“ªä¸€é¡ï¼Ÿ",
            options: [
                { text: "ğŸ¦ éƒ½æ˜¯æ”¾éŠ€è¡Œã€è²·å„²è“„éšªï¼ˆä½é¢¨éšªï¼‰", score: 1 },
                { text: "ğŸ§© æœ‰è²·å‚µåˆ¸ã€æ¯”è¼ƒç©©å®šçš„åŸºé‡‘", score: 2 },
                { text: "âš–ï¸ æ¯”è¼ƒå¹³å‡ï¼Œä»€éº¼éƒ½ç¢°ä¸€é»", score: 3 },
                { text: "ğŸ“ˆ è‚¡ç¥¨ã€ETF æ¯”è¼ƒå¤š", score: 4 },
                { text: "ğŸ° æœŸè²¨ã€é¸æ“‡æ¬Šã€å¹£åœˆæˆ‘éƒ½ç©é", score: 5 },
            ],
        },
        {
            question: "æ‚¨æ›¾ç¶“æŠ•å…¥ ã€Œè‚¡ç¥¨ã€åŸºé‡‘æˆ–è‚¡ç¥¨ETFã€ çš„é‡‘é¡å¤§ç´„æ˜¯å¤šå°‘ï¼Ÿ",
            options: [
                { text: "ğŸ†• å®Œå…¨æ²’æŠ•è³‡éï¼ä¸çŸ¥é“é€™æ˜¯ä»€éº¼", score: 1 },
                { text: "ğŸ’¡ è©¦éä¸€é»é»ï¼ˆå°‘æ–¼ NT$10,000ï¼‰", score: 2 },
                { text: "ğŸ“ˆ æŠ•å…¥é NT$10,000ï½30,000ï¼ˆå¯èƒ½æ˜¯å®šæœŸå®šé¡æˆ–ä¸€æ¬¡æŠ•å…¥ï¼‰", score: 3 },
                { text: "ğŸ§± æŠ•å…¥é NT$30,001ï½100,000ï¼ˆæ¯”è¼ƒèªçœŸè¦åŠƒï¼‰", score: 4 },
                { text: "ğŸ’¼ è¶…é NT$100,000ï¼ˆé•·æœŸç•¶æˆè³‡ç”¢é…ç½®ä¸€éƒ¨åˆ†ï¼‰", score: 5 },
            ],
        },
        {
            // ä¿®æ­£ï¼šå°‡å•é¡Œä¸­çš„æ¢åˆ—é …ç›®å‰åŠ ä¸Š <br> æ›è¡Œï¼Œç¢ºä¿æ ¼å¼æ­£ç¢º
            question: "é—œæ–¼æ‚¨è·Ÿç†è²¡ï¼é‡‘èçš„æ¥è§¸ç¶“æ­·ï¼Œæ‚¨ç¬¦åˆä¸‹åˆ—å¹¾é …ï¼Ÿ<br><br><div class='text-left text-base font-normal pl-4 space-y-2'> <p>(1) æ›¾åœ¨é‡‘èæ¥­ï¼ˆå¦‚ä¿éšªã€è­‰åˆ¸ã€æœƒè¨ˆï¼‰æ‰“éå·¥æˆ–å¯¦ç¿’</p> <p>(2) æ‹¿éé‡‘èè­‰ç…§ï¼ˆå¦‚è­‰åˆ¸ã€ä¿¡è¨—ã€ç†è²¡è¦åŠƒï¼‰</p> <p>(3) ä¸Šéç†è²¡èª²ã€æŠ•è³‡è¬›åº§ã€æˆ–æœ‰åƒåŠ é‡‘èç¤¾åœ˜</p> <p>(4) æ˜¯å•†å­¸é™¢æˆ–è²¡ç¶“ç›¸é—œç§‘ç³»çš„å­¸ç”Ÿ</p> </div>",
            options: [
                { text: "0 é … ğŸ‘‰ å®Œå…¨å°ç™½", score: 1 },
                { text: "1 é … ğŸ‘‰ æœ‰ä¸€é»é»ç¶“é©—", score: 2 },
                { text: "2 é … ğŸ‘‰ é‚„ç®—ç†Ÿæ‚‰", score: 3 },
                { text: "3 é … ğŸ‘‰ æ‚¨å¾ˆæœ‰æ¦‚å¿µå–”", score: 4 },
                { text: "4 é … ğŸ‘‰ å°ˆæ¥­ç´šå¹´è¼•äººï¼", score: 5 },
            ],
        },
    ];

    const riskProfileData = {
        conservative: {
            type: "ä¿å®ˆå‹",
            desc: "æ‚¨é‡è¦–æœ¬é‡‘å®‰å…¨ï¼Œå°å¸‚å ´æ³¢å‹•çš„å®¹å¿åº¦è¼ƒä½ï¼ŒæŠ•è³‡ç›®æ¨™ä»¥ä¿å€¼å’Œç©©å®šæ”¶ç›Šç‚ºä¸»ã€‚",
            tools: "å®šå­˜ã€å„²è“„éšªã€è²¨å¹£å‹åŸºé‡‘ã€æŠ•è³‡ç­‰ç´šå‚µåˆ¸",
            allocation: { conservative: 80, moderate: 20, aggressive: 0 },
            rates: { conservative: 0.035, moderate: 0.07, aggressive: 0.10 }
        },
        moderate: {
            type: "ç©©å¥å‹",
            desc: "æ‚¨é¡˜æ„ç‚ºäº†è¿½æ±‚é•·æœŸç©©å®šçš„æˆé•·è€Œæ‰¿æ“”ä¸­åº¦é¢¨éšªï¼Œå°‹æ±‚åœ¨é¢¨éšªèˆ‡å ±é…¬ä¹‹é–“å–å¾—å¹³è¡¡ã€‚",
            tools: "è‚¡ç¥¨å‹ ETFã€å¹³è¡¡å‹åŸºé‡‘ã€å‚µåˆ¸å‹åŸºé‡‘",
            allocation: { conservative: 30, moderate: 50, aggressive: 20 },
            rates: { conservative: 0.035, moderate: 0.07, aggressive: 0.10 }
        },
        aggressive: {
            type: "ç©æ¥µå‹",
            desc: "æ‚¨ä¸ç•æ‡¼é¢¨éšªï¼Œé¡˜æ„æ‰¿å—è¼ƒå¤§çš„å¸‚å ´æ³¢å‹•ä»¥æ›å–æ›´é«˜çš„ç²åˆ©æ©Ÿæœƒï¼ŒæŠ•è³‡ç›®æ¨™ç‚ºè³‡æœ¬çš„æœ€å¤§åŒ–å¢é•·ã€‚",
            tools: "æˆé•·è‚¡ã€ä¸»é¡Œå¼ETFã€æœŸè²¨ã€åŠ å¯†è²¨å¹£",
            allocation: { conservative: 10, moderate: 40, aggressive: 50 },
            rates: { conservative: 0.035, moderate: 0.07, aggressive: 0.10 }
        },
    };

    let currentQuestionIndex = 0;
    const userAnswers = [];
    const quizQuestionContainer = document.getElementById('quiz-question-container');
    const prevBtn = document.getElementById('prev-question');
    const nextBtn = document.getElementById('next-question');
    const questionIndicator = document.getElementById('question-indicator');

    function renderQuestion() {
        const questionData = quizData[currentQuestionIndex];
        let optionsHTML = '';
        questionData.options.forEach((opt) => {
            const isSelected = userAnswers[currentQuestionIndex] === opt.score;
            optionsHTML += `<div class="quiz-option border-2 p-4 rounded-lg cursor-pointer hover:bg-gray-100 ${isSelected ? 'selected' : ''}" data-score="${opt.score}">
                <p class="font-semibold">${opt.text}</p>
            </div>`;
        });
        // ä¿®æ­£ï¼šå°‡å•é¡Œå®¹å™¨å¾ h4 æ”¹ç‚º divï¼Œä»¥æ­£ç¢ºå®¹ç´ HTML æ ¼å¼
        quizQuestionContainer.innerHTML = `
            <div class="text-lg font-semibold mb-4">${currentQuestionIndex + 1}. ${questionData.question}</div>
            <div class="space-y-3">${optionsHTML}</div>
        `;
        questionIndicator.textContent = `${currentQuestionIndex + 1} / ${quizData.length}`;
        updateQuizNav();
        
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', (e) => {
                userAnswers[currentQuestionIndex] = parseInt(e.currentTarget.dataset.score);
                renderQuestion(); 
            });
        });
    }

    function updateQuizNav() {
        prevBtn.disabled = currentQuestionIndex === 0;
        nextBtn.disabled = userAnswers[currentQuestionIndex] === undefined || userAnswers[currentQuestionIndex] === null;
        if (currentQuestionIndex === quizData.length - 1) {
            nextBtn.textContent = 'çœ‹çµæœ';
        } else {
            nextBtn.textContent = 'ä¸‹ä¸€é¡Œ';
        }
    }

    prevBtn.addEventListener('click', () => {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            renderQuestion();
        }
    });

    nextBtn.addEventListener('click', () => {
        if (currentQuestionIndex < quizData.length - 1) {
            currentQuestionIndex++;
            renderQuestion();
        } else {
            calculateAndShowResult();
        }
    });

    function calculateAndShowResult() {
        const totalScore = userAnswers.reduce((sum, score) => sum + score, 0);

        let riskType = '';
        if (totalScore <= 23) {
            riskType = 'conservative';
        } else if (totalScore <= 37) {
            riskType = 'moderate';
        } else {
            riskType = 'aggressive';
        }
        appState.riskProfile = riskType;

        const profile = riskProfileData[riskType];
        document.getElementById('result-type').textContent = profile.type;
        document.getElementById('result-desc').textContent = profile.desc;
        document.getElementById('result-tools').textContent = profile.tools;
        
        const allocation = profile.allocation;
        document.getElementById('result-allocation').innerHTML = `
            ä¿å®ˆå‹: <span class="font-bold text-teal-700">${allocation.conservative}%</span> | 
            ç©©å¥å‹: <span class="font-bold text-teal-700">${allocation.moderate}%</span> | 
            ç©æ¥µå‹: <span class="font-bold text-teal-700">${allocation.aggressive}%</span>
        `;

        document.getElementById('risk-quiz').classList.add('hidden');
        document.getElementById('risk-result').classList.remove('hidden');

        setPortfolioAllocation(riskType);
    }
    
    document.getElementById('retake-quiz').addEventListener('click', () => {
        currentQuestionIndex = 0;
        userAnswers.length = 0;
        appState.riskProfile = null;
        document.getElementById('risk-result').classList.add('hidden');
        document.getElementById('risk-quiz').classList.remove('hidden');
        renderQuestion();
        setPortfolioAllocation(null);
    });

    renderQuestion();

    // --- Oracle Card Game Logic ---
    const oracleCardsContainer = document.getElementById('oracle-cards-container');
    const oracleResultContainer = document.getElementById('oracle-result-container');
    const oracleInstruction = document.getElementById('oracle-instruction');
    const oracleRedrawBtn = document.getElementById('oracle-redraw-btn');
    
    const oracleCardData = [
        {
            emoji: 'ğŸ¿ï¸',
            title: 'è¬¹æ…çš„æ¾é¼ ',
            analysis: 'ä½ æ“…é•·å„²è“„ã€ç©ç©€é˜²é¥‘ï¼Œå°é‡‘éŒ¢å¾ˆæœ‰å®‰å…¨æ„Ÿã€‚ä½†æœ‰æ™‚éæ–¼ä¿å®ˆï¼Œå¯èƒ½æœƒéŒ¯éè®“è³‡ç”¢æˆé•·çš„æ©Ÿæœƒã€‚',
            guidance: 'ç¥è«­æŒ‡å¼•ï¼šä½ çš„å„²è“„ç¿’æ…£å¾ˆæ£’ï¼ä»Šå¹´è©¦è‘—å°‡ 10% çš„å„²è“„æŠ•å…¥åˆ°ç©©å¥çš„ ETF ä¸­ï¼Œè®“ä½ çš„æœå¯¦ç‚ºä½ é•·å‡ºæ›´å¤šæœå¯¦å§ï¼'
        },
        {
            emoji: 'ğŸ¦…',
            title: 'ç„¡ç•çš„çµé·¹',
            analysis: 'ä½ çœ¼å…‰ç²¾æº–ã€å‹‡äºå†’éšªï¼Œä¸ç•æ‡¼é¢¨éšªï¼Œä¸¦ç›¸ä¿¡é«˜é¢¨éšªèƒ½å¸¶ä¾†é«˜å›å ±ã€‚ä½†è¦å°å¿ƒï¼Œæœ‰æ™‚å¯èƒ½æœƒéæ–¼è¡å‹•ã€‚',
            guidance: 'ç¥è«­æŒ‡å¼•ï¼šä½ çš„å‹‡æ°£å¯å˜‰ï¼ä»Šå¹´åœ¨è¿½é€é«˜å›å ±çš„åŒæ™‚ï¼Œè¨˜å¾—è¨­å®šå¥½åœæé»ï¼Œç‚ºä½ çš„å†’éšªåŠ ä¸Šä¸€å±¤ä¿è­·ç¶²ã€‚'
        },
        {
            emoji: 'ğŸ',
            title: 'å‹¤å¥®çš„èœœèœ‚',
            analysis: 'ä½ æ“…é•·é€éå¤šå…ƒç®¡é“å¢åŠ æ”¶å…¥ï¼Œåƒèœœèœ‚ä¸€æ¨£å‹¤å‹åœ°ç´¯ç©è²¡å¯Œï¼Œç©å°‘æˆå¤šã€‚ä½†æœ‰æ™‚å¯èƒ½æœƒå› ç‚ºå¤ªå¿™è€Œå¿½ç•¥äº†ç†è²¡è¦åŠƒã€‚',
            guidance: 'ç¥è«­æŒ‡å¼•ï¼šä½ çš„è¾›å‹¤çµ‚å°‡å›å ±ï¼ä»Šå¹´è©¦è‘—è¨­å®šä¸€å€‹æ¯æœˆè‡ªå‹•æ‰£æ¬¾çš„å®šæœŸå®šé¡æŠ•è³‡ï¼Œè®“ä½ çš„è²¡å¯Œä¹Ÿèƒ½è‡ªå‹•å·¥ä½œã€‚'
        },
        {
            emoji: 'ğŸ•Šï¸',
            title: 'æ™ºæ…§çš„ç™½é´¿',
            analysis: 'ä½ å–„æ–¼æ”¶é›†è³‡è¨Šï¼Œåšå‡ºç†æ€§çš„åˆ¤æ–·ï¼Œä¸å–œæ­¡äººäº‘äº¦äº‘ã€‚ä½†åœ¨è³‡è¨Šçˆ†ç‚¸çš„æ™‚ä»£ï¼Œæœ‰æ™‚å¯èƒ½æœƒå› ç‚ºæƒ³å¤ªå¤šè€ŒçŒ¶è±«ä¸æ±ºã€‚',
            guidance: 'ç¥è«­æŒ‡å¼•ï¼šä½ çš„æ™ºæ…§æ˜¯æœ€å¤§è³‡ç”¢ï¼ä»Šå¹´ç›¸ä¿¡ä½ çš„åˆ¤æ–·ï¼Œå‹‡æ•¢è¸å‡ºç¬¬ä¸€æ­¥ï¼Œé¸æ“‡ä¸€å€‹ä½ çœ‹å¥½çš„é ˜åŸŸé–‹å§‹å°é¡æŠ•è³‡å§ï¼'
        }
    ];

    function setupOracleGame() {
        oracleCardsContainer.innerHTML = '';
        oracleResultContainer.classList.add('hidden');
        oracleCardsContainer.classList.remove('hidden');
        oracleInstruction.classList.remove('hidden');

        const cardBacks = ['ğŸŒŸ', 'ğŸŒ™', 'â˜€ï¸', 'ğŸª'];
        const shuffledData = [...oracleCardData].sort(() => 0.5 - Math.random());

        shuffledData.forEach((cardData, index) => {
            const cardEl = document.createElement('div');
            cardEl.className = 'oracle-card';
            cardEl.innerHTML = `
                <div class="oracle-card-inner">
                    <div class="oracle-card-back">${cardBacks[index]}</div>
                    <div class="oracle-card-front p-2">
                        <div class="text-4xl">${cardData.emoji}</div>
                        <h5 class="font-bold text-sm mt-2">${cardData.title}</h5>
                    </div>
                </div>
            `;
            cardEl.addEventListener('click', () => revealOracleCard(cardEl, cardData), { once: true });
            oracleCardsContainer.appendChild(cardEl);
        });
    }

    function revealOracleCard(cardEl, cardData) {
        document.querySelectorAll('.oracle-card').forEach(c => c.style.pointerEvents = 'none');
        cardEl.classList.add('flipped');

        setTimeout(() => {
            document.getElementById('oracle-result-emoji').textContent = cardData.emoji;
            document.getElementById('oracle-result-title').textContent = cardData.title;
            document.getElementById('oracle-result-analysis').textContent = cardData.analysis;
            document.getElementById('oracle-result-guidance').textContent = cardData.guidance;
            
            oracleCardsContainer.classList.add('hidden');
            oracleInstruction.classList.add('hidden');
            oracleResultContainer.classList.remove('hidden');
        }, 600);
    }

    oracleRedrawBtn.addEventListener('click', setupOracleGame);
    setupOracleGame();

    // --- Swipe to Save Game Logic ---
    const swipeCardStack = document.getElementById('swipe-card-stack');
    const swipeGameContainer = document.getElementById('swipe-game-container');
    const swipeResultContainer = document.getElementById('swipe-result-container');
    const passBtn = document.getElementById('pass-btn');
    const buyBtn = document.getElementById('buy-btn');
    const swipeRestartBtn = document.getElementById('swipe-restart-btn');

    const swipeCardData = [
        { item: 'æœ€æ–°æ¬¾ AirPods', cost: 7490, emoji: 'ğŸ§' },
        { item: 'é€±æœ«é›»å½±ç¥¨+çˆ†ç±³èŠ±', cost: 500, emoji: 'ğŸ¿' },
        { item: 'ä¿¡ç¾©å€é…’å§å–ä¸€æ¯', cost: 400, emoji: 'ğŸ¸' },
        { item: 'é™é‡ç‰ˆè¯åçƒé‹', cost: 5800, emoji: 'ğŸ‘Ÿ' },
        { item: 'æ‰‹éŠèª²é‡‘ä¸€å–®', cost: 2990, emoji: 'ğŸ®' },
        { item: 'ç‡’è‚‰åƒåˆ°é£½å¤§é¤', cost: 1500, emoji: 'ğŸ–' },
        { item: 'Netflix æœˆè²»', cost: 390, emoji: 'ğŸ“º' },
        { item: 'é€±æœ«è¨ˆç¨‹è»Šè²»', cost: 350, emoji: 'ğŸš•' },
        { item: 'ä¸€æ¯æ‰‹æ–é£²', cost: 70, emoji: 'ğŸ¥¤' },
        { item: 'ç¶²è³¼ä¸€ä»¶æ–°è¡£æœ', cost: 1200, emoji: 'ğŸ‘•' },
        { item: 'æ¼”å”±æœƒé–€ç¥¨', cost: 3800, emoji: 'ğŸ¤' },
        { item: 'é€±æœ«å°æ—…è¡Œ', cost: 6000, emoji: 'ğŸ•ï¸' },
        { item: 'æœ€æ–°æ¬¾æ‰‹æ©Ÿæ®¼', cost: 800, emoji: 'ğŸ“±' },
        { item: 'å¤–é€ä¸‹åˆèŒ¶', cost: 250, emoji: 'ğŸ°' },
        { item: 'å¥èº«æˆ¿å–®æ¬¡å…¥å ´', cost: 500, emoji: 'ğŸ’ª' },
        { item: 'ä¸€å ‚ç·šä¸Šèª²ç¨‹', cost: 1500, emoji: 'ğŸ“š' },
        { item: 'å‰ªé«®+æŸ“é«®', cost: 3000, emoji: 'ğŸ’‡â€â™€ï¸' },
        { item: 'è·Ÿæœ‹å‹å»KTV', cost: 800, emoji: 'ğŸ¶' },
        { item: 'è²·ä¸€æœ¬æ–°æ›¸', cost: 450, emoji: 'ğŸ“–' },
        { item: 'ææ¬¾çµ¦æ…ˆå–„æ©Ÿæ§‹', cost: 300, emoji: 'ğŸ’–' }
    ];

    let currentSwipeCardIndex;
    let savedAmount;
    let passedCount;
    let activeSwipeCards = [];

    function setupSwipeGame() {
        currentSwipeCardIndex = 0;
        savedAmount = 0;
        passedCount = 0;
        swipeGameContainer.classList.remove('hidden');
        swipeResultContainer.classList.add('hidden');
        
        const shuffled = [...swipeCardData].sort(() => 0.5 - Math.random());
        activeSwipeCards = shuffled.slice(0, 10);
        renderSwipeCards(activeSwipeCards);
    }

    function renderSwipeCards(cards) {
        swipeCardStack.innerHTML = '';
        cards.forEach((card, index) => {
            const cardEl = document.createElement('div');
            cardEl.className = 'swipe-card';
            cardEl.style.zIndex = cards.length - index;
            cardEl.style.transform = `translateY(${index * -4}px) scale(${1 - index * 0.05})`;
            cardEl.innerHTML = `
                <div class="text-4xl">${card.emoji}</div>
                <p class="font-bold mt-2">${card.item}</p>
                <p class="text-gray-600">NT$ ${card.cost.toLocaleString()}</p>
            `;
            swipeCardStack.appendChild(cardEl);
        });
    }

    function handleSwipe(action) {
        const cards = swipeCardStack.querySelectorAll('.swipe-card');
        if (currentSwipeCardIndex >= cards.length) return;

        const cardData = activeSwipeCards[currentSwipeCardIndex];
        const cardEl = cards[currentSwipeCardIndex];

        if (action === 'pass') {
            savedAmount += cardData.cost;
            passedCount++;
            cardEl.style.transform = 'translateX(-150%) rotate(-15deg)';
        } else {
            cardEl.style.transform = 'translateX(150%) rotate(15deg)';
        }
        cardEl.style.opacity = '0';

        currentSwipeCardIndex++;

        for (let i = currentSwipeCardIndex; i < cards.length; i++) {
            const card = cards[i];
            const relativeIndex = i - currentSwipeCardIndex;
            card.style.transform = `translateY(${relativeIndex * -4}px) scale(${1 - relativeIndex * 0.05})`;
        }

        if (currentSwipeCardIndex >= cards.length) {
            setTimeout(showSwipeResults, 300);
        }
    }
    
    function showSwipeResults() {
        const investedSavedAmount = savedAmount * 1.07;
        document.getElementById('passed-count').textContent = passedCount;
        document.getElementById('saved-amount').textContent = savedAmount.toLocaleString();
        document.getElementById('invested-saved-amount').textContent = `NT$ ${Math.round(investedSavedAmount).toLocaleString()}`;
        swipeGameContainer.classList.add('hidden');
        swipeResultContainer.classList.remove('hidden');
    }

    passBtn.addEventListener('click', () => handleSwipe('pass'));
    buyBtn.addEventListener('click', () => handleSwipe('buy'));
    swipeRestartBtn.addEventListener('click', setupSwipeGame);
    setupSwipeGame();

    const investmentTools = [
        {
            name: "æ•¸ä½æ´»å­˜", risk: "ä½", icon: "ğŸ“±",
            brief: "é«˜åˆ©æ´»å­˜ï¼Œæ‰‹æ©Ÿæ“ä½œ",
            details: {
                advantages: ["éš¨æ™‚å­˜å–ï¼Œéˆæ´»æ€§é«˜", "åˆ©ç‡å„ªæ–¼å‚³çµ±æ´»å­˜", "æ“ä½œä¾¿æ·ï¼Œç„¡å¯¦é«”å­˜æ‘º"],
                disadvantages: ["åˆ©ç‡ä»ä½æ–¼é€šè†¨", "æ”¶ç›Šæœ‰é™ï¼Œé›£ä»¥å°æŠ—è³‡ç”¢ç¸®æ°´"],
                suitableFor: "çŸ­æœŸè³‡é‡‘åœæ³Šã€ç·Šæ€¥å‚™ç”¨é‡‘",
                interactive: {
                    type: "interest_calculator",
                    title: "æ´»å­˜åˆ©æ¯è¨ˆç®— (å¹´)",
                    content: `
                        <div class="space-y-3">
                            <div>
                                <label for="interest-amount" class="block text-sm font-medium text-gray-700">è¼¸å…¥é‡‘é¡ (NT$)</label>
                                <input type="number" id="interest-amount" placeholder="ä¾‹å¦‚: 100000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="interest-rate" class="block text-sm font-medium text-gray-700">å¹´åˆ©ç‡ (%)</label>
                                <input type="number" id="interest-rate" value="1.0" step="0.1" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <p id="interest-result" class="mt-2 font-bold h-6"></p>
                        </div>
                    `
                }
            }
        },
        {
            name: "å‚µåˆ¸ETF", risk: "ä½", icon: "âš–ï¸",
            brief: "å®šæœŸé…æ¯ï¼Œé¢¨éšªç©©å¥",
            details: {
                advantages: ["é¢¨éšªç›¸å°è¼ƒä½ï¼Œæ³¢å‹•å°", "å®šæœŸé…æ¯æä¾›ç¾é‡‘æµ", "åˆ†æ•£æŠ•è³‡å¤šç¨®å‚µåˆ¸"],
                disadvantages: ["æ”¶ç›Šç‡é€šå¸¸è¼ƒä½", "åˆ©ç‡ä¸Šå‡å¯èƒ½å°è‡´åƒ¹æ ¼ä¸‹è·Œ"],
                suitableFor: "ç©©å¥å‹æŠ•è³‡è€…ã€å°‹æ±‚å›ºå®šæ”¶ç›Šè€…",
                interactive: {
                    type: "text_info",
                    title: "å‚µåˆ¸ETFé‹ä½œèªªæ˜",
                    content: `
                        <p class="text-gray-700">å‚µåˆ¸ETFçš„åƒ¹æ ¼æ³¢å‹•è¼ƒå°ï¼Œä¸»è¦æ”¶ç›Šä¾†è‡ªæ–¼å®šæœŸé…æ¯ã€‚å®ƒæŠ•è³‡æ–¼ä¸€ç±ƒå­å‚µåˆ¸ï¼Œæœ‰åŠ©æ–¼åˆ†æ•£é¢¨éšªã€‚ç•¶å¸‚å ´åˆ©ç‡ä¸Šå‡æ™‚ï¼Œæ–°ç™¼è¡Œçš„å‚µåˆ¸æœƒæä¾›æ›´é«˜çš„æ”¶ç›Šç‡ï¼Œé€™æœƒä½¿å¾—å¸‚å ´ä¸Šå·²æœ‰çš„ã€æ”¶ç›Šç‡è¼ƒä½çš„èˆŠå‚µåˆ¸å¸å¼•åŠ›ä¸‹é™ï¼Œå¾è€Œå°è‡´å‚µåˆ¸ETFçš„åƒ¹æ ¼ä¸‹è·Œï¼›åä¹‹ï¼Œåˆ©ç‡ä¸‹é™å‰‡å¯èƒ½ä½¿åƒ¹æ ¼ä¸Šæ¼²ã€‚</p>
                        <p class="text-gray-700 mt-2">å‚µåˆ¸ETFæ˜¯è¿½æ±‚ç©©å®šæ”¶ç›Šå’Œè¼ƒä½é¢¨éšªçš„æŠ•è³‡è€…ç†æƒ³é¸æ“‡ã€‚</p>
                    `
                }
            }
        },
        {
            name: "è‚¡ç¥¨", risk: "é«˜", icon: "ğŸ“ˆ",
            brief: "é«˜é¢¨éšªé«˜å ±é…¬",
            details: {
                advantages: ["æ½›åœ¨å ±é…¬é«˜ï¼Œå¯èƒ½å¿«é€Ÿç²åˆ©", "åƒèˆ‡å…¬å¸æˆé•·ï¼Œåˆ†äº«ç¶“ç‡Ÿæˆæœ", "äº¤æ˜“éˆæ´»ï¼Œè²·è³£æ–¹ä¾¿"],
                disadvantages: ["æ³¢å‹•å¤§ï¼Œé¢¨éšªé«˜ï¼Œå¯èƒ½å¿«é€Ÿè™§ææœ¬é‡‘", "éœ€è¦æ·±å…¥ç ”ç©¶å…¬å¸åŸºæœ¬é¢å’Œç”¢æ¥­è¶¨å‹¢", "å¸‚å ´æ¶ˆæ¯é¢å½±éŸ¿å¤§"],
                suitableFor: "ç©æ¥µå‹æŠ•è³‡è€…ã€æœ‰æ™‚é–“å’Œèƒ½åŠ›ç ”ç©¶å€‹è‚¡è€…ã€é¡˜æ„æ‰¿å—è¼ƒé«˜é¢¨éšªè€…",
                interactive: {
                    type: "profit_calculator",
                    title: "è‚¡ç¥¨æç›Šè¨ˆç®—",
                    content: `
                        <div class="space-y-3">
                            <div>
                                <label for="stock-buy-price" class="block text-sm font-medium text-gray-700">è²·å…¥åƒ¹æ ¼ (NT$)</label>
                                <input type="number" id="stock-buy-price" placeholder="ä¾‹å¦‚: 100" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="stock-sell-price" class="block text-sm font-medium text-gray-700">è³£å‡ºåƒ¹æ ¼ (NT$)</label>
                                <input type="number" id="stock-sell-price" placeholder="ä¾‹å¦‚: 110" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="stock-shares" class="block text-sm font-medium text-gray-700">è‚¡æ•¸ (å–®ä½: è‚¡)</label>
                                <input type="number" id="stock-shares" placeholder="ä¾‹å¦‚: 1000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <p id="stock-profit-result" class="mt-2 font-bold h-6"></p>
                        </div>
                    `
                }
            }
        },
        {
            name: "è‚¡ç¥¨ETF", risk: "ä¸­", icon: "ğŸ§º",
            brief: "åˆ†æ•£é¢¨éšªï¼Œå…é¸è‚¡",
            details: {
                advantages: ["åˆ†æ•£æŠ•è³‡ï¼Œé™ä½å€‹è‚¡é¢¨éšª", "äº¤æ˜“æ–¹ä¾¿ï¼Œåƒè‚¡ç¥¨ä¸€æ¨£è²·è³£", "è²»ç”¨ç‡é€šå¸¸è¼ƒä½ï¼Œé€æ˜åº¦é«˜"],
                disadvantages: ["ç„¡æ³•è¶…è¶Šå¤§ç›¤è¡¨ç¾ï¼Œåªèƒ½è³ºå–å¸‚å ´å¹³å‡å ±é…¬", "ä»å—å¸‚å ´ç³»çµ±æ€§é¢¨éšªå½±éŸ¿", "éƒ¨åˆ†ç‰¹å®šä¸»é¡ŒETFæ³¢å‹•å¯èƒ½è¼ƒå¤§"],
                suitableFor: "ç©©å¥å‹æŠ•è³‡è€…ã€è¿½æ±‚å¸‚å ´å¹³å‡å ±é…¬è€…ã€ä¸æ“…é•·é¸è‚¡è€…",
                interactive: {
                    type: "dca_future_value_calculator",
                    title: "å®šæœŸå®šé¡æœªä¾†åƒ¹å€¼æ¨¡æ“¬",
                    content: `
                        <div class="space-y-3 mb-6">
                            <div>
                                <label for="dca-monthly-amount" class="block text-sm font-medium text-gray-700">æ¯æœˆæŠ•å…¥é‡‘é¡ (NT$)</label>
                                <input type="number" id="dca-monthly-amount" value="3000" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="dca-years" class="block text-sm font-medium text-gray-700">é è¨ˆæŠ•è³‡å¹´æ•¸</label>
                                <input type="number" id="dca-years" value="10" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <div>
                                <label for="dca-annual-rate" class="block text-sm font-medium text-gray-700">é æœŸå¹´åŒ–å ±é…¬ç‡ (%)</label>
                                <input type="number" id="dca-annual-rate" value="7.0" step="0.1" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-teal-500 focus:border-teal-500">
                            </div>
                            <p id="dca-total-invested-result" class="mt-4 text-base font-semibold text-gray-700"></p>
                            <p id="dca-future-value-result" class="mt-2 text-xl font-bold text-teal-600"></p>
                        </div>
                    `
                }
            }
        },
        {
            name: "åŸºé‡‘", risk: "ä¸­", icon: "ğŸ§‘â€ğŸ’¼",
            brief: "å°ˆäººç®¡ç†ï¼Œå¤šå…ƒæ¨™çš„",
            details: {
                advantages: ["å°ˆæ¥­ç¶“ç†äººç®¡ç†ï¼Œçœå»ç ”ç©¶æ™‚é–“", "æŠ•è³‡ç¯„åœå»£æ³›ï¼Œå¯è·¨åœ‹ã€è·¨ç”¢æ¥­ã€è·¨è³‡ç”¢é…ç½®", "å°é¡è³‡é‡‘å³å¯åƒèˆ‡å¤šç¨®æŠ•è³‡æ¨™çš„"],
                disadvantages: ["ç®¡ç†è²»å’Œæ‰‹çºŒè²»é€šå¸¸è¼ƒé«˜", "ç¸¾æ•ˆä¾è³´ç¶“ç†äººèƒ½åŠ›ï¼Œå¯èƒ½è·‘è¼¸å¤§ç›¤", "è´–å›æœ‰æ™‚æ•ˆæ€§ï¼Œè³‡é‡‘ç„¡æ³•å³æ™‚å–å›"],
                suitableFor: "ç©©å¥å‹æŠ•è³‡è€…ã€å¸Œæœ›å°ˆæ¥­ä»£æ“è€…ã€ç¼ºä¹æ™‚é–“ç ”ç©¶å¸‚å ´è€…",
                interactive: {
                    type: "text_info",
                    title: "åŸºé‡‘é‹ä½œèªªæ˜",
                    content: `
                        <p class="text-gray-700">åŸºé‡‘æ˜¯ç”±ä¸€ç¾¤æŠ•è³‡äººçš„è³‡é‡‘åŒ¯é›†è€Œæˆï¼Œäº¤ç”±å°ˆæ¥­ç¶“ç†äººä»£ç‚ºæ“ä½œï¼ŒæŠ•è³‡æ–¼è‚¡ç¥¨ã€å‚µåˆ¸ã€è²¨å¹£ç­‰å¤šå…ƒè³‡ç”¢ã€‚åŸºé‡‘çš„ç¨®é¡ç¹å¤šï¼Œå¯ä»¥æ ¹æ“šæŠ•è³‡ç›®æ¨™å’Œé¢¨éšªæ‰¿å—èƒ½åŠ›é¸æ“‡é©åˆçš„é¡å‹ã€‚</p>
                        <p class="text-gray-700 mt-2">é›–ç„¶åŸºé‡‘æœ‰ç®¡ç†è²»ç”¨ï¼Œä½†å°æ–¼æ²’æœ‰æ™‚é–“æˆ–å°ˆæ¥­çŸ¥è­˜ç ”ç©¶å¸‚å ´çš„æŠ•è³‡è€…ä¾†èªªï¼Œé€éå°ˆæ¥­ç®¡ç†ä¾†é”åˆ°è³‡ç”¢å¢å€¼æ˜¯ä¸€å€‹ä¸éŒ¯çš„é¸æ“‡ã€‚</p>
                    `
                }
            }
        },
        {
            name: "æœŸè²¨", risk: "é«˜", icon: "ğŸš€",
            brief: "æ§“æ¡¿æ“ä½œï¼ŒæŒ‘æˆ°æ€§é«˜",
            details: {
                advantages: ["é«˜æ§“æ¡¿ï¼Œæ½›åœ¨å ±é…¬é«˜ï¼Œå¯èƒ½å¿«é€Ÿç²åˆ©", "å¤šç©ºçš†å¯æ“ä½œï¼Œç„¡è«–æ¼²è·Œéƒ½æœ‰ç²åˆ©æ©Ÿæœƒ", "äº¤æ˜“æˆæœ¬ç›¸å°ä½ï¼Œæµå‹•æ€§é«˜"],
                disadvantages: ["é¢¨éšªæ¥µé«˜ï¼Œå¯èƒ½å¿«é€Ÿè™§æç”šè‡³è¶…éæœ¬é‡‘", "éœ€è¦åš´æ ¼çš„é¢¨éšªæ§åˆ¶å’Œåœæç´€å¾‹", "ä¿è­‰é‡‘è¿½ç¹³å£“åŠ›ï¼Œå¸‚å ´æ³¢å‹•å¤§æ™‚å¯èƒ½é¢è‡¨å¼·åˆ¶å¹³å€‰"],
                suitableFor: "ç¶“é©—è±å¯Œçš„ç©æ¥µå‹æŠ•è³‡è€…ã€æœ‰èƒ½åŠ›æ‰¿å—å·¨å¤§é¢¨éšªè€…ã€å°å¸‚å ´æœ‰æ·±å…¥ç†è§£è€…",
                interactive: {
                    type: "futures_calculator",
                    title: "æœŸè²¨æ§“æ¡¿èˆ‡æç›Šæ¨¡æ“¬",
                    content: `
                        <div class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="futures-type-modal" class="block text-sm font-medium text-gray-700">é¸æ“‡æœŸè²¨åˆç´„</label>
                                    <select id="futures-type-modal" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                                        <option value="200" data-margin="357000">å¤§å°æŒ‡ (1é»=200å…ƒ)</option>
                                        <option value="50" data-margin="89250" selected>å°å°æŒ‡ (1é»=50å…ƒ)</option>
                                        <option value="10" data-margin="17850">å¾®å‹è‡ºæŒ‡ (1é»=10å…ƒ)</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="futures-index-price-modal" class="block text-sm font-medium text-gray-700">ç•¶æ™‚æŒ‡æ•¸åƒ¹æ ¼</label>
                                    <input type="number" id="futures-index-price-modal" value="23000" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">
                                </div>
                            </div>
                             <div>
                                <label for="futures-points-modal" class="block text-sm font-medium text-gray-700">é æœŸæŒ‡æ•¸è®Šå‹•é»æ•¸ (å¯ç‚ºè² æ•¸)</label>
                                <input type="number" id="futures-points-modal" placeholder="ä¾‹å¦‚: 100 æˆ– -100" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm">
                            </div>
                            <div class="bg-gray-100 p-4 rounded-lg space-y-2 text-sm">
                                <p>åŸå§‹ä¿è­‰é‡‘: <span class="font-semibold float-right" id="futures-margin-modal"></span></p>
                                <p>åˆç´„ç¸½åƒ¹å€¼: <span class="font-semibold float-right" id="futures-contract-value-modal"></span></p>
                                <p>æ“ä½œæ§“æ¡¿å€æ•¸: <span class="font-semibold float-right text-amber-600" id="futures-leverage-modal"></span></p>
                                <hr>
                                <p class="text-base">é ä¼°æç›Š: <span class="font-bold float-right" id="futures-result-modal"></span></p>
                                <p class="text-base">ä¿è­‰é‡‘å ±é…¬ç‡: <span class="font-bold float-right" id="futures-roi-modal"></span></p>
                            </div>
                            <p class="text-xs text-gray-500 text-center">ä¿è­‰é‡‘é‡‘é¡ç‚ºæ’°å¯«ç•¶ä¸‹ä¹‹åƒè€ƒå€¼ï¼Œå¯¦éš›é‡‘é¡è«‹ä¾æœŸäº¤æ‰€å…¬å‘Šç‚ºæº–ã€‚</p>
                        </div>
                    `
                }
            }
        }
    ];
    const toolsContainer = document.getElementById('investment-tools-container');
    toolsContainer.innerHTML = investmentTools.map((tool, index) => `
        <div class="p-3 border-2 rounded-lg bg-white cursor-pointer hover:shadow-md hover:-translate-y-1 transition-all" data-index="${index}">
            <div class="text-4xl mb-2">${tool.icon}</div>
            <p class="font-bold">${tool.name}</p>
            <p class="text-xs text-gray-500 mb-1">${tool.brief}</p>
            <span class="text-xs px-2 py-0.5 rounded-full ${tool.risk === 'ä½' ? 'bg-green-100 text-green-800' : tool.risk === 'ä¸­' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}">${tool.risk}é¢¨éšª</span>
        </div>
    `).join('');

    const toolDetailModalOverlay = document.getElementById('tool-detail-modal-overlay');
    const closeToolDetailModalBtn = document.getElementById('close-tool-detail-modal');
    const toolDetailIcon = document.getElementById('tool-detail-icon');
    const toolDetailName = document.getElementById('tool-detail-name');
    const toolDetailRisk = document.getElementById('tool-detail-risk');
    const toolDetailAdvantages = document.getElementById('tool-detail-advantages');
    const toolDetailDisadvantages = document.getElementById('tool-detail-disadvantages');
    const toolDetailSuitable = document.getElementById('tool-detail-suitable');
    const interactiveSectionTitle = document.getElementById('interactive-section-title');
    const interactiveContent = document.getElementById('interactive-content');

    function showToolDetails(index) {
        const tool = investmentTools[index];
        toolDetailIcon.textContent = tool.icon;
        toolDetailName.textContent = tool.name;
        toolDetailRisk.textContent = `${tool.risk}é¢¨éšª`;
        toolDetailRisk.className = `text-sm px-3 py-1 rounded-full font-medium mt-2 inline-block ${tool.risk === 'ä½' ? 'bg-green-100 text-green-800' : tool.risk === 'ä¸­' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}`;

        toolDetailAdvantages.innerHTML = tool.details.advantages.map(adv => `<li>${adv}</li>`).join('');
        toolDetailDisadvantages.innerHTML = tool.details.disadvantages.map(disadv => `<li>${disadv}</li>`).join('');
        toolDetailSuitable.textContent = tool.details.suitableFor;

        interactiveSectionTitle.textContent = tool.details.interactive.title;
        interactiveContent.innerHTML = tool.details.interactive.content;

        if (tool.details.interactive.type === 'interest_calculator') {
            const amountInput = document.getElementById('interest-amount');
            const rateInput = document.getElementById('interest-rate');
            const resultDisplay = document.getElementById('interest-result');

            const calculateInterest = () => {
                const amount = parseFloat(amountInput.value);
                const rate = parseFloat(rateInput.value) / 100;
                if (!isNaN(amount) && !isNaN(rate)) {
                    const interest = amount * rate;
                    resultDisplay.textContent = `é ä¼°å¹´åˆ©æ¯: NT$ ${interest.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
                    resultDisplay.style.color = interest >= 0 ? '#10B981' : '#EF4444';
                } else {
                    resultDisplay.textContent = '';
                }
            };
            amountInput.addEventListener('input', calculateInterest);
            rateInput.addEventListener('input', calculateInterest);
            calculateInterest();
        } else if (tool.details.interactive.type === 'profit_calculator') {
            const buyPriceInput = document.getElementById('stock-buy-price');
            const sellPriceInput = document.getElementById('stock-sell-price');
            const sharesInput = document.getElementById('stock-shares');
            const resultDisplay = document.getElementById('stock-profit-result');

            const calculateProfit = () => {
                const buyPrice = parseFloat(buyPriceInput.value);
                const sellPrice = parseFloat(sellPriceInput.value);
                const shares = parseFloat(sharesInput.value);
                if (!isNaN(buyPrice) && !isNaN(sellPrice) && !isNaN(shares)) {
                    const profit = (sellPrice - buyPrice) * shares;
                    resultDisplay.textContent = `é ä¼°æç›Š: NT$ ${profit.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
                    resultDisplay.style.color = profit >= 0 ? '#10B981' : '#EF4444';
                } else {
                    resultDisplay.textContent = '';
                }
            };
            buyPriceInput.addEventListener('input', calculateProfit);
            sellPriceInput.addEventListener('input', calculateProfit);
            sharesInput.addEventListener('input', calculateProfit);
            calculateProfit();
        } else if (tool.details.interactive.type === 'futures_calculator') {
            const futuresTypeModal = document.getElementById('futures-type-modal');
            const futuresIndexPriceModal = document.getElementById('futures-index-price-modal');
            const futuresPointsModal = document.getElementById('futures-points-modal');
            const futuresResultModal = document.getElementById('futures-result-modal');
            const futuresMarginModal = document.getElementById('futures-margin-modal');
            const futuresContractValueModal = document.getElementById('futures-contract-value-modal');
            const futuresLeverageModal = document.getElementById('futures-leverage-modal');
            const futuresRoiModal = document.getElementById('futures-roi-modal');

            const calculateFuturesModal = () => {
                const selectedOption = futuresTypeModal.options[futuresTypeModal.selectedIndex];
                const pointValue = parseFloat(selectedOption.value);
                const margin = parseFloat(selectedOption.dataset.margin);
                
                const indexPrice = parseFloat(futuresIndexPriceModal.value) || 0;
                const pointsChange = parseFloat(futuresPointsModal.value) || 0;

                const contractValue = indexPrice * pointValue;
                const leverage = contractValue / margin;
                const profitOrLoss = pointsChange * pointValue;
                const returnOnMargin = (profitOrLoss / margin) * 100;

                futuresMarginModal.textContent = `NT$ ${margin.toLocaleString()}`;
                futuresContractValueModal.textContent = `NT$ ${contractValue.toLocaleString()}`;
                futuresLeverageModal.textContent = `${leverage.toFixed(1)} å€`;
                
                if (pointsChange !== 0) {
                    futuresResultModal.textContent = `NT$ ${profitOrLoss.toLocaleString()}`;
                    futuresResultModal.style.color = profitOrLoss >= 0 ? '#10B981' : '#EF4444';
                    futuresRoiModal.textContent = `${returnOnMargin.toFixed(2)}%`;
                    futuresRoiModal.style.color = returnOnMargin >= 0 ? '#10B981' : '#EF4444';
                } else {
                    futuresResultModal.textContent = '---';
                    futuresResultModal.style.color = 'inherit';
                    futuresRoiModal.textContent = '---';
                    futuresRoiModal.style.color = 'inherit';
                }
            };
            
            futuresTypeModal.addEventListener('change', calculateFuturesModal);
            futuresIndexPriceModal.addEventListener('input', calculateFuturesModal);
            futuresPointsModal.addEventListener('input', calculateFuturesModal);
            calculateFuturesModal(); // Initial calculation
        } else if (tool.details.interactive.type === 'dca_future_value_calculator') {
            const monthlyAmountInput = document.getElementById('dca-monthly-amount');
            const yearsInput = document.getElementById('dca-years');
            const annualRateInput = document.getElementById('dca-annual-rate');
            const futureValueDisplay = document.getElementById('dca-future-value-result');
            const totalInvestedDisplay = document.getElementById('dca-total-invested-result');

            const calculateDCAFutureValue = () => {
                const P = parseFloat(monthlyAmountInput.value);
                const years = parseFloat(yearsInput.value);
                const annualRate = parseFloat(annualRateInput.value);

                if (isNaN(P) || isNaN(years) || isNaN(annualRate) || P <= 0 || years <= 0) {
                    futureValueDisplay.textContent = 'è«‹è¼¸å…¥æœ‰æ•ˆæ•¸å€¼';
                    futureValueDisplay.style.color = '#EF4444';
                    totalInvestedDisplay.textContent = '';
                    return;
                }

                const r_annual = annualRate / 100;
                const r_monthly = r_annual / 12;
                const n_months = years * 12;

                let futureValue = 0;
                if (r_monthly === 0) {
                    futureValue = P * n_months;
                } else {
                    futureValue = P * ((Math.pow(1 + r_monthly, n_months) - 1) / r_monthly) * (1 + r_monthly);
                }
                
                const totalInvested = P * n_months;

                totalInvestedDisplay.textContent = `åŸå§‹æŠ•å…¥æˆæœ¬: NT$ ${totalInvested.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
                futureValueDisplay.textContent = `é è¨ˆæœªä¾†ç¸½å€¼: NT$ ${futureValue.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
                futureValueDisplay.style.color = '#4A908A';
            };

            monthlyAmountInput.addEventListener('input', calculateDCAFutureValue);
            yearsInput.addEventListener('input', calculateDCAFutureValue);
            annualRateInput.addEventListener('input', calculateDCAFutureValue);
            calculateDCAFutureValue();
        }


        toolDetailModalOverlay.classList.add('active');
    }

    toolsContainer.querySelectorAll('.p-3').forEach(card => {
        card.addEventListener('click', (e) => {
            const index = parseInt(e.currentTarget.dataset.index);
            showToolDetails(index);
        });
    });

    closeToolDetailModalBtn.addEventListener('click', () => {
        toolDetailModalOverlay.classList.remove('active');
    });

    toolDetailModalOverlay.addEventListener('click', (e) => {
        if (e.target === toolDetailModalOverlay) {
            toolDetailModalOverlay.classList.remove('active');
        }
    });

    // Image Modal Logic
    const imageModalOverlay = document.getElementById('image-modal-overlay');
    const closeImageModalBtn = document.getElementById('close-image-modal');
    const imageModalImg = document.getElementById('image-modal-img');

    const etfImages = {
        'name-dividend': 'images/ETFåç¨±.png',
        'expense-ratio': 'images/ç®¡ç†è²».png',
        'dividend-frequency': 'images/é…æ¯.png',
        'composition': 'images/ç”¢æ¥­é…ç½®.png',
        'premium-discount': 'images/æŠ˜æº¢åƒ¹.png'
    };

    document.querySelectorAll('[data-image-modal]').forEach(button => {
        button.addEventListener('click', (e) => {
            const imageKey = e.currentTarget.dataset.imageModal;
            const imageUrl = etfImages[imageKey];
            if (imageUrl) {
                imageModalImg.src = imageUrl;
                imageModalOverlay.classList.add('active');
            } else {
                console.error('Image URL not found for key:', imageKey);
            }
        });
    });

    closeImageModalBtn.addEventListener('click', () => {
        imageModalOverlay.classList.remove('active');
        imageModalImg.src = '';
    });

    imageModalOverlay.addEventListener('click', (e) => {
        if (e.target === imageModalOverlay) {
            imageModalOverlay.classList.remove('active');
            imageModalImg.src = '';
        }
    });


    const etfData = {
        labels: ['0050 (å°ç£50)', '0056 (é«˜è‚¡æ¯)'],
        datasets: [
            {
                label: '2å¹´å¹³å‡å¹´åŒ–å ±é…¬',
                data: [18.11, 8.76],
                backgroundColor: 'rgba(74, 144, 138, 0.6)',
                borderColor: 'rgba(74, 144, 138, 1)',
                borderWidth: 1,
            },
            {
                label: '10å¹´å¹³å‡å¹´åŒ–å ±é…¬',
                data: [8.23, 6.99],
                backgroundColor: 'rgba(245, 166, 35, 0.6)',
                borderColor: 'rgba(245, 166, 35, 1)',
                borderWidth: 1,
            }
        ]
    };
    new Chart(document.getElementById('etf-comparison-chart').getContext('2d'), {
        type: 'bar',
        data: etfData,
        options: {
            responsive: true, maintainAspectRatio: false,
            plugins: { legend: { position: 'top' }, title: { display: true, text: 'ç†±é–€ETFå ±é…¬ç‡æ¯”è¼ƒ (%)' } },
            scales: { y: { beginAtZero: true } }
        }
    });

    // --- ROBO ADVISOR LOGIC ---
    let assetGrowthChart;
    const roboInputs = document.querySelectorAll('.robo-input');
    const successProbabilityEl = document.getElementById('success-probability');
    const combinedReturnRateEl = document.getElementById('combined-return-rate');
    
    // MODIFICATION START: Updated selectors and added new ones for number inputs
    const portfolioAllocInputs = {
        conservative: document.getElementById('conservative-alloc-input'),
        moderate: document.getElementById('moderate-alloc-input'),
        aggressive: document.getElementById('aggressive-alloc-input'),
    };
    const remainingAllocPctEl = document.getElementById('remaining-alloc-pct');
    // MODIFICATION END

    function setPortfolioAllocation(riskType) {
        let allocations;
        if (riskType && riskProfileData[riskType]) {
            allocations = riskProfileData[riskType].allocation;
        } else {
            // Default allocation if no profile
            allocations = { conservative: 34, moderate: 33, aggressive: 33 };
        }
        
        appState.portfolioAllocation = {...allocations};
        updatePortfolioUI();
        runRoboAdvisorSimulation();
    }

    function updatePortfolioUI() {
        let total = 0;
        for (const type in appState.portfolioAllocation) {
            const value = Math.round(appState.portfolioAllocation[type]);
            portfolioAllocInputs[type].value = value;
            total += value;
        }
        const remaining = 100 - total;
        remainingAllocPctEl.textContent = `${remaining}%`;
        remainingAllocPctEl.style.color = remaining < 0 ? '#EF4444' : '#4A908A';
    }

    Object.values(portfolioAllocInputs).forEach(input => {
        input.addEventListener('input', handleAllocationChange);
    });

    function handleAllocationChange() {
        let total = 0;
        const values = {};

        // Read all values first
        for (const type in portfolioAllocInputs) {
            let val = parseInt(portfolioAllocInputs[type].value) || 0;
            if (val < 0) val = 0;
            if (val > 100) val = 100;
            values[type] = val;
            total += val;
        }

        // If total exceeds 100, we just update the display, but don't auto-correct
        // This allows users to manually fix it.
        const remaining = 100 - total;
        remainingAllocPctEl.textContent = `${remaining}%`;
        remainingAllocPctEl.style.color = remaining < 0 ? '#EF4444' : '#4A908A';

        // Update state only if the total is valid (<= 100)
        if (total <= 100) {
            appState.portfolioAllocation.conservative = values.conservative;
            appState.portfolioAllocation.moderate = values.moderate;
            appState.portfolioAllocation.aggressive = values.aggressive;
        }
        
        // Always run simulation to reflect changes
        runRoboAdvisorSimulation();
    }


    function runRoboAdvisorSimulation() {
        const goalAmount = parseFloat(document.getElementById('goal-amount').value);
        const years = parseInt(document.getElementById('goal-years').value);
        const lumpSum = parseFloat(document.getElementById('lump-sum').value);
        const monthlyInvestment = parseFloat(document.getElementById('monthly-investment').value);

        if (isNaN(goalAmount) || isNaN(years) || isNaN(lumpSum) || isNaN(monthlyInvestment) || years <= 0 || goalAmount <= 0) {
            successProbabilityEl.textContent = 'è«‹è¼¸å…¥æœ‰æ•ˆæ•¸å€¼';
            combinedReturnRateEl.textContent = '--%';
            updateAssetGrowthChart(null);
            return;
        }
        
        // Recalculate total from inputs for simulation
        let currentTotal = 0;
        for (const type in portfolioAllocInputs) {
            currentTotal += (parseInt(portfolioAllocInputs[type].value) || 0);
        }

        if (currentTotal > 100) {
             successProbabilityEl.textContent = 'æ¯”ä¾‹>100%';
             combinedReturnRateEl.textContent = '--%';
             updateAssetGrowthChart(null);
             return;
        }


        const rates = riskProfileData.conservative.rates; // rates are the same for all profiles
        const alloc = {
            conservative: parseInt(portfolioAllocInputs.conservative.value) || 0,
            moderate: parseInt(portfolioAllocInputs.moderate.value) || 0,
            aggressive: parseInt(portfolioAllocInputs.aggressive.value) || 0,
        };
        
        const annualRate = (alloc.conservative / 100 * rates.conservative) +
                           (alloc.moderate / 100 * rates.moderate) +
                           (alloc.aggressive / 100 * rates.aggressive);

        combinedReturnRateEl.textContent = `${(annualRate * 100).toFixed(2)}%`;

        // Calculate projected future value
        const monthlyRate = annualRate / 12;
        const n = years * 12;
        const fvLumpSum = lumpSum * Math.pow(1 + monthlyRate, n);
        const fvMonthly = monthlyInvestment * ( (Math.pow(1 + monthlyRate, n) - 1) / monthlyRate );
        const projectedFv = fvLumpSum + fvMonthly;

        let probability = (projectedFv / goalAmount) * 100;
        if (probability > 99) probability = 99;
        
        successProbabilityEl.textContent = `${Math.round(probability)}%`;

        const chartData = { goalAmount, years, lumpSum, monthlyInvestment, annualRate };
        updateAssetGrowthChart(chartData);
    }

    function updateAssetGrowthChart(data) {
        const ctx = document.getElementById('asset-growth-chart').getContext('2d');
        if (!data) {
            if (assetGrowthChart) {
                assetGrowthChart.destroy();
                assetGrowthChart = null;
            }
            return;
        }

        const { goalAmount, years, lumpSum, monthlyInvestment, annualRate } = data;
        const labels = Array.from({length: years + 1}, (_, i) => `ç¬¬ ${i} å¹´`);
        const projectedData = [];
        let currentValue = lumpSum;
        projectedData.push(currentValue);

        for (let year = 1; year <= years; year++) {
            currentValue = (currentValue + monthlyInvestment * 12) * (1 + annualRate);
            projectedData.push(currentValue);
        }

        const chartConfig = {
            labels: labels,
            datasets: [
                {
                    label: 'é è¨ˆè³‡ç”¢æˆé•·',
                    data: projectedData,
                    borderColor: '#4A908A',
                    backgroundColor: 'rgba(74, 144, 138, 0.1)',
                    fill: true,
                    tension: 0.2
                },
                {
                    label: 'ç›®æ¨™é‡‘é¡',
                    data: Array(years + 1).fill(goalAmount),
                    borderColor: '#F59E0B',
                    borderDash: [5, 5],
                    fill: false,
                    pointRadius: 0
                }
            ]
        };

        if (assetGrowthChart) {
            assetGrowthChart.data = chartConfig;
            assetGrowthChart.update();
        } else {
            assetGrowthChart = new Chart(ctx, {
                type: 'line',
                data: chartConfig,
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { title: { display: false } },
                    scales: { y: { ticks: { callback: (value) => `NT$${(value/10000).toFixed(0)}è¬` } } }
                }
            });
        }
    }

    roboInputs.forEach(input => input.addEventListener('input', runRoboAdvisorSimulation));
    setPortfolioAllocation(null); // Initial run with default allocation

    // --- Hedging Simulator Logic ---
    const hedgeStockValueInput = document.getElementById('hedge-stock-value');
    const hedgeMarketDeclineInput = document.getElementById('hedge-market-decline');

    function calculateHedging() {
        const stockValue = parseFloat(hedgeStockValueInput.value) || 0;
        const declinePercent = parseFloat(hedgeMarketDeclineInput.value) || 0;

        const lossAmount = stockValue * (declinePercent / 100);

        const noHedgeFinal = stockValue - lossAmount;
        document.getElementById('no-hedge-initial').textContent = `NT$ ${stockValue.toLocaleString()}`;
        document.getElementById('no-hedge-loss').textContent = `- NT$ ${lossAmount.toLocaleString()}`;
        document.getElementById('no-hedge-final').textContent = `NT$ ${noHedgeFinal.toLocaleString()}`;

        const futuresProfit = lossAmount;
        const hedgeFinal = stockValue - lossAmount + futuresProfit;
        document.getElementById('hedge-initial').textContent = `NT$ ${stockValue.toLocaleString()}`;
        document.getElementById('hedge-stock-loss').textContent = `- NT$ ${lossAmount.toLocaleString()}`;
        document.getElementById('hedge-futures-profit').textContent = `+ NT$ ${futuresProfit.toLocaleString()}`;
        document.getElementById('hedge-final').textContent = `NT$ ${hedgeFinal.toLocaleString()}`;
    }

    hedgeStockValueInput.addEventListener('input', calculateHedging);
    hedgeMarketDeclineInput.addEventListener('input', calculateHedging);
    calculateHedging();

    // --- Tutorial Gallery Logic ---
    const tutorialSteps = [
        { src: 'images/1.png', title: 'æ­¥é©Ÿ 1: ç™»å…¥ç¾¤ç›Šè¡Œå‹•è´å®¶' },
        { src: 'images/2.png', title: 'æ­¥é©Ÿ 2: é»æ“Šä¸‹æ–¹ã€Œäº¤æ˜“åŠŸèƒ½ã€' },
        { src: 'images/3.png', title: 'æ­¥é©Ÿ 3: é€²å…¥ã€ŒæœŸè²¨ä¸‹å–®ã€' },
        { src: 'images/4.png', title: 'æ­¥é©Ÿ 4: é»æ“Šã€Œå•†å“ã€é€²è¡Œé¸æ“‡' },
        { src: 'images/5.png', title: 'æ­¥é©Ÿ 5: é¸æ“‡ã€ŒæŒ‡æ•¸ã€ï¼Œå†é»é¸ã€Œå°å°æŒ‡è¿‘ã€æˆ–ã€Œå¾®å‹å°æŒ‡è¿‘ã€' },
        { src: 'images/6.png', title: 'æ­¥é©Ÿ 6: ç¢ºèªå•†å“å¾Œï¼Œé¸æ“‡ã€Œè³£å‡ºã€' },
        { src: 'images/7.png', title: 'æ­¥é©Ÿ 7: é»é¸ã€ŒRODã€' },
        { src: 'images/8.png', title: 'æ­¥é©Ÿ 8: é¸æ“‡ã€Œå¸‚åƒ¹ã€' },
        { src: 'images/9.png', title: 'æ­¥é©Ÿ 9: è¼¸å…¥æ‚¨è¦ä¸‹å–®çš„ã€Œå£æ•¸ã€' },
        { src: 'images/10.png', title: 'æ­¥é©Ÿ 10: æŒ‰ä¸‹ã€Œä¸‹å–®ã€' },
        { src: 'images/11.png', title: 'æ­¥é©Ÿ 11: ç¢ºèªä¸‹å–®è³‡è¨Šå¾Œï¼Œé€å‡ºå³å¯' },
    ];

    const openTutorialBtn = document.getElementById('open-tutorial-btn');
    const galleryModalOverlay = document.getElementById('gallery-modal-overlay');
    const closeGalleryModalBtn = document.getElementById('close-gallery-modal');
    const galleryModalTitle = document.getElementById('gallery-modal-title');
    const galleryModalImg = document.getElementById('gallery-modal-img');
    const galleryPrevBtn = document.getElementById('gallery-prev-btn');
    const galleryNextBtn = document.getElementById('gallery-next-btn');
    const galleryStepIndicator = document.getElementById('gallery-step-indicator');
    
    let currentStepIndex = 0;

    function showStep(index) {
        const step = tutorialSteps[index];
        galleryModalImg.src = step.src;
        galleryModalTitle.textContent = step.title;
        galleryStepIndicator.textContent = `æ­¥é©Ÿ ${index + 1} / ${tutorialSteps.length}`;
        
        galleryPrevBtn.disabled = index === 0;
        galleryNextBtn.disabled = index === tutorialSteps.length - 1;
    }

    openTutorialBtn.addEventListener('click', () => {
        currentStepIndex = 0;
        showStep(currentStepIndex);
        galleryModalOverlay.classList.add('active');
    });

    closeGalleryModalBtn.addEventListener('click', () => {
        galleryModalOverlay.classList.remove('active');
    });

    galleryModalOverlay.addEventListener('click', (e) => {
        if (e.target === galleryModalOverlay) {
            galleryModalOverlay.classList.remove('active');
        }
    });

    galleryPrevBtn.addEventListener('click', () => {
        if (currentStepIndex > 0) {
            currentStepIndex--;
            showStep(currentStepIndex);
        }
    });

    galleryNextBtn.addEventListener('click', () => {
        if (currentStepIndex < tutorialSteps.length - 1) {
            currentStepIndex++;
            showStep(currentStepIndex);
        }
    });

    // Rate Info Modal Logic
    const rateInfoBtn = document.getElementById('rate-info-btn');
    const rateInfoModalOverlay = document.getElementById('rate-info-modal-overlay');
    const closeRateInfoModalBtn = document.getElementById('close-rate-info-modal');

    rateInfoBtn.addEventListener('click', () => {
        rateInfoModalOverlay.classList.add('active');
    });
    closeRateInfoModalBtn.addEventListener('click', () => {
        rateInfoModalOverlay.classList.remove('active');
    });
    rateInfoModalOverlay.addEventListener('click', (e) => {
        if (e.target === rateInfoModalOverlay) {
            rateInfoModalOverlay.classList.remove('active');
        }
    });

});
</script>
</body>
</html>
